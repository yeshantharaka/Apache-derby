<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_66) on Mon Jul 03 23:05:07 IST 2017 -->
<title>DD_Version (Apache Derby V10.13 Internals)</title>
<meta name="date" content="2017-07-03">
<link rel="stylesheet" type="text/css" href="../../../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="DD_Version (Apache Derby V10.13 Internals)";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":10,"i1":10,"i2":10,"i3":10,"i4":10,"i5":10,"i6":10,"i7":10,"i8":9,"i9":9,"i10":10,"i11":10,"i12":10,"i13":10,"i14":10};
var tabs = {65535:["t0","All Methods"],1:["t1","Static Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../../org/apache/derby/impl/sql/catalog/DataDictionaryImpl.html" title="class in org.apache.derby.impl.sql.catalog"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../../../org/apache/derby/impl/sql/catalog/DDColumnDependableFinder.html" title="class in org.apache.derby.impl.sql.catalog"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../../index.html?org/apache/derby/impl/sql/catalog/DD_Version.html" target="_top">Frames</a></li>
<li><a href="DD_Version.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">org.apache.derby.impl.sql.catalog</div>
<h2 title="Class DD_Version" class="title">Class DD_Version</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>org.apache.derby.impl.sql.catalog.DD_Version</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd>java.io.Externalizable, java.io.Serializable, <a href="../../../../../../org/apache/derby/iapi/services/io/Formatable.html" title="interface in org.apache.derby.iapi.services.io">Formatable</a>, <a href="../../../../../../org/apache/derby/iapi/services/io/TypedFormat.html" title="interface in org.apache.derby.iapi.services.io">TypedFormat</a></dd>
</dl>
<hr>
<br>
<pre>public class <span class="typeNameLabel">DD_Version</span>
extends java.lang.Object
implements <a href="../../../../../../org/apache/derby/iapi/services/io/Formatable.html" title="interface in org.apache.derby.iapi.services.io">Formatable</a></pre>
<div class="block">Generic code for upgrading data dictionaries.
 Currently has all minor version upgrade logic.
 <p>
 A word about minor vs. major upgraded.  Minor
 upgrades must be backwards/forwards compatible.
 So they cannot version classes or introduce new
 classes.  Major releases are only backwards compatible;
 they will run against an old database, but not the
 other way around.  So they can introduce new classes,
 etc.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../../serialized-form.html#org.apache.derby.impl.sql.catalog.DD_Version">Serialized Form</a></dd>
</dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private <a href="../../../../../../org/apache/derby/impl/sql/catalog/DataDictionaryImpl.html" title="class in org.apache.derby.impl.sql.catalog">DataDictionaryImpl</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/sql/catalog/DD_Version.html#bootingDictionary">bootingDictionary</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/sql/catalog/DD_Version.html#majorVersionNumber">majorVersionNumber</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/sql/catalog/DD_Version.html#minorVersionNumber">minorVersionNumber</a></span></code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/sql/catalog/DD_Version.html#DD_Version--">DD_Version</a></span>()</code>
<div class="block">Public niladic constructor needed for Formatable interface.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/sql/catalog/DD_Version.html#DD_Version-org.apache.derby.impl.sql.catalog.DataDictionaryImpl-int-">DD_Version</a></span>(<a href="../../../../../../org/apache/derby/impl/sql/catalog/DataDictionaryImpl.html" title="class in org.apache.derby.impl.sql.catalog">DataDictionaryImpl</a>&nbsp;bootingDictionary,
          int&nbsp;majorVersionNumber)</code>
<div class="block">Construct a Version for the currently booting data dictionary.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t1" class="tableTab"><span><a href="javascript:show(1);">Static Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/sql/catalog/DD_Version.html#applySafeChanges-org.apache.derby.iapi.store.access.TransactionController-int-int-">applySafeChanges</a></span>(<a href="../../../../../../org/apache/derby/iapi/store/access/TransactionController.html" title="interface in org.apache.derby.iapi.store.access">TransactionController</a>&nbsp;tc,
                int&nbsp;fromMajorVersionNumber,
                int&nbsp;lastSoftUpgradeVersion)</code>
<div class="block">Apply changes that can safely be made in soft upgrade.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>(package private) boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/sql/catalog/DD_Version.html#checkVersion-int-java.lang.String-">checkVersion</a></span>(int&nbsp;requiredMajorVersion,
            java.lang.String&nbsp;feature)</code>
<div class="block">Check to see if a database has been upgraded to the required
                level in order to use a language feature.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/sql/catalog/DD_Version.html#doFullUpgrade-org.apache.derby.iapi.store.access.TransactionController-int-java.lang.String-">doFullUpgrade</a></span>(<a href="../../../../../../org/apache/derby/iapi/store/access/TransactionController.html" title="interface in org.apache.derby.iapi.store.access">TransactionController</a>&nbsp;tc,
             int&nbsp;fromMajorVersionNumber,
             java.lang.String&nbsp;aid)</code>
<div class="block">Do full upgrade.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/sql/catalog/DD_Version.html#dropSystemCatalog-org.apache.derby.iapi.store.access.TransactionController-org.apache.derby.iapi.sql.dictionary.CatalogRowFactory-">dropSystemCatalog</a></span>(<a href="../../../../../../org/apache/derby/iapi/store/access/TransactionController.html" title="interface in org.apache.derby.iapi.store.access">TransactionController</a>&nbsp;tc,
                 <a href="../../../../../../org/apache/derby/iapi/sql/dictionary/CatalogRowFactory.html" title="class in org.apache.derby.iapi.sql.dictionary">CatalogRowFactory</a>&nbsp;crf)</code>
<div class="block">Drop a System catalog.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/sql/catalog/DD_Version.html#dropSystemCatalogDescription-org.apache.derby.iapi.store.access.TransactionController-org.apache.derby.iapi.sql.dictionary.TableDescriptor-">dropSystemCatalogDescription</a></span>(<a href="../../../../../../org/apache/derby/iapi/store/access/TransactionController.html" title="interface in org.apache.derby.iapi.store.access">TransactionController</a>&nbsp;tc,
                            <a href="../../../../../../org/apache/derby/iapi/sql/dictionary/TableDescriptor.html" title="class in org.apache.derby.iapi.sql.dictionary">TableDescriptor</a>&nbsp;td)</code>
<div class="block">Remove the description of a System table from the data dictionary.</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>private int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/sql/catalog/DD_Version.html#getJBMSMinorVersionNumber--">getJBMSMinorVersionNumber</a></span>()</code>
<div class="block">Get the minor version from the JBMS product minor version/maint version.</div>
</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/sql/catalog/DD_Version.html#getTypeFormatId--">getTypeFormatId</a></span>()</code>
<div class="block">Get the formatID which corresponds to this class.</div>
</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/sql/catalog/DD_Version.html#handleMinorRevisionChange-org.apache.derby.iapi.store.access.TransactionController-org.apache.derby.impl.sql.catalog.DD_Version-boolean-">handleMinorRevisionChange</a></span>(<a href="../../../../../../org/apache/derby/iapi/store/access/TransactionController.html" title="interface in org.apache.derby.iapi.store.access">TransactionController</a>&nbsp;tc,
                         <a href="../../../../../../org/apache/derby/impl/sql/catalog/DD_Version.html" title="class in org.apache.derby.impl.sql.catalog">DD_Version</a>&nbsp;fromVersion,
                         boolean&nbsp;softUpgradeRun)</code>
<div class="block">Do any work needed for a minor revision change.</div>
</td>
</tr>
<tr id="i8" class="altColor">
<td class="colFirst"><code>private static boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/sql/catalog/DD_Version.html#isFullUpgrade-java.util.Properties-java.lang.String-">isFullUpgrade</a></span>(java.util.Properties&nbsp;startParams,
             java.lang.String&nbsp;oldVersionInfo)</code>
<div class="block">Privileged startup.</div>
</td>
</tr>
<tr id="i9" class="rowColor">
<td class="colFirst"><code>private static java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/sql/catalog/DD_Version.html#majorToString-int-">majorToString</a></span>(int&nbsp;majorVersionNumber)</code>&nbsp;</td>
</tr>
<tr id="i10" class="altColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/sql/catalog/DD_Version.html#modifySysTableNullability-org.apache.derby.iapi.store.access.TransactionController-int-">modifySysTableNullability</a></span>(<a href="../../../../../../org/apache/derby/iapi/store/access/TransactionController.html" title="interface in org.apache.derby.iapi.store.access">TransactionController</a>&nbsp;tc,
                         int&nbsp;catalogNum)</code>
<div class="block">Modifies the nullability of the system table corresponding
 to the received catalog number.</div>
</td>
</tr>
<tr id="i11" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/sql/catalog/DD_Version.html#readExternal-java.io.ObjectInput-">readExternal</a></span>(java.io.ObjectInput&nbsp;in)</code>
<div class="block">Read this object from a stream of stored objects.</div>
</td>
</tr>
<tr id="i12" class="altColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/sql/catalog/DD_Version.html#toString--">toString</a></span>()</code>
<div class="block">Stringify this Version.</div>
</td>
</tr>
<tr id="i13" class="rowColor">
<td class="colFirst"><code>(package private) void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/sql/catalog/DD_Version.html#upgradeIfNeeded-org.apache.derby.impl.sql.catalog.DD_Version-org.apache.derby.iapi.store.access.TransactionController-java.util.Properties-">upgradeIfNeeded</a></span>(<a href="../../../../../../org/apache/derby/impl/sql/catalog/DD_Version.html" title="class in org.apache.derby.impl.sql.catalog">DD_Version</a>&nbsp;dictionaryVersion,
               <a href="../../../../../../org/apache/derby/iapi/store/access/TransactionController.html" title="interface in org.apache.derby.iapi.store.access">TransactionController</a>&nbsp;tc,
               java.util.Properties&nbsp;startParams)</code>
<div class="block">Upgrade the data dictionary catalogs to the version represented by this
 DD_Version.</div>
</td>
</tr>
<tr id="i14" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/sql/catalog/DD_Version.html#writeExternal-java.io.ObjectOutput-">writeExternal</a></span>(java.io.ObjectOutput&nbsp;out)</code>
<div class="block">Write this object to a stream of stored objects.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="bootingDictionary">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>bootingDictionary</h4>
<pre>private transient&nbsp;<a href="../../../../../../org/apache/derby/impl/sql/catalog/DataDictionaryImpl.html" title="class in org.apache.derby.impl.sql.catalog">DataDictionaryImpl</a> bootingDictionary</pre>
</li>
</ul>
<a name="majorVersionNumber">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>majorVersionNumber</h4>
<pre>int majorVersionNumber</pre>
</li>
</ul>
<a name="minorVersionNumber">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>minorVersionNumber</h4>
<pre>private&nbsp;int minorVersionNumber</pre>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="DD_Version--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>DD_Version</h4>
<pre>public&nbsp;DD_Version()</pre>
<div class="block">Public niladic constructor needed for Formatable interface.</div>
</li>
</ul>
<a name="DD_Version-org.apache.derby.impl.sql.catalog.DataDictionaryImpl-int-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>DD_Version</h4>
<pre>DD_Version(<a href="../../../../../../org/apache/derby/impl/sql/catalog/DataDictionaryImpl.html" title="class in org.apache.derby.impl.sql.catalog">DataDictionaryImpl</a>&nbsp;bootingDictionary,
           int&nbsp;majorVersionNumber)</pre>
<div class="block">Construct a Version for the currently booting data dictionary.
 The minor version is set by the subclass.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>bootingDictionary</code> - The booting dictionary that needs to be upgraded.</dd>
</dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="toString--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>toString</h4>
<pre>public&nbsp;java.lang.String&nbsp;toString()</pre>
<div class="block">Stringify this Version.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Overrides:</span></dt>
<dd><code>toString</code>&nbsp;in class&nbsp;<code>java.lang.Object</code></dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>String representation of this Version.</dd>
</dl>
</li>
</ul>
<a name="majorToString-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>majorToString</h4>
<pre>private static&nbsp;java.lang.String&nbsp;majorToString(int&nbsp;majorVersionNumber)</pre>
</li>
</ul>
<a name="upgradeIfNeeded-org.apache.derby.impl.sql.catalog.DD_Version-org.apache.derby.iapi.store.access.TransactionController-java.util.Properties-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>upgradeIfNeeded</h4>
<pre>void&nbsp;upgradeIfNeeded(<a href="../../../../../../org/apache/derby/impl/sql/catalog/DD_Version.html" title="class in org.apache.derby.impl.sql.catalog">DD_Version</a>&nbsp;dictionaryVersion,
                     <a href="../../../../../../org/apache/derby/iapi/store/access/TransactionController.html" title="interface in org.apache.derby.iapi.store.access">TransactionController</a>&nbsp;tc,
                     java.util.Properties&nbsp;startParams)
              throws <a href="../../../../../../org/apache/derby/iapi/error/StandardException.html" title="class in org.apache.derby.iapi.error">StandardException</a></pre>
<div class="block">Upgrade the data dictionary catalogs to the version represented by this
 DD_Version.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>dictionaryVersion</code> - the version of the data dictionary tables.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../../org/apache/derby/iapi/error/StandardException.html" title="class in org.apache.derby.iapi.error">StandardException</a></code> - Ooops</dd>
</dl>
</li>
</ul>
<a name="applySafeChanges-org.apache.derby.iapi.store.access.TransactionController-int-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>applySafeChanges</h4>
<pre>private&nbsp;void&nbsp;applySafeChanges(<a href="../../../../../../org/apache/derby/iapi/store/access/TransactionController.html" title="interface in org.apache.derby.iapi.store.access">TransactionController</a>&nbsp;tc,
                              int&nbsp;fromMajorVersionNumber,
                              int&nbsp;lastSoftUpgradeVersion)
                       throws <a href="../../../../../../org/apache/derby/iapi/error/StandardException.html" title="class in org.apache.derby.iapi.error">StandardException</a></pre>
<div class="block">Apply changes that can safely be made in soft upgrade.
                Any changes must not prevent the database from being re-booted
                by the a Derby engine at the older version fromMajorVersionNumber.
                <BR>
                Examples are fixes to catalog meta data, e.g. fix nullability of
                a system column.

                <BR>
                <B>Upgrade items for 10.1</B>
                <UL>
                <LI> None.
                </UL></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>tc</code> - transaction controller</dd>
<dd><code>fromMajorVersionNumber</code> - version of the on-disk database</dd>
<dd><code>lastSoftUpgradeVersion</code> - last engine to perform a soft upgrade that made changes.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../../org/apache/derby/iapi/error/StandardException.html" title="class in org.apache.derby.iapi.error">StandardException</a></code> - Standard Derby error policy.</dd>
</dl>
</li>
</ul>
<a name="doFullUpgrade-org.apache.derby.iapi.store.access.TransactionController-int-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>doFullUpgrade</h4>
<pre>private&nbsp;void&nbsp;doFullUpgrade(<a href="../../../../../../org/apache/derby/iapi/store/access/TransactionController.html" title="interface in org.apache.derby.iapi.store.access">TransactionController</a>&nbsp;tc,
                           int&nbsp;fromMajorVersionNumber,
                           java.lang.String&nbsp;aid)
                    throws <a href="../../../../../../org/apache/derby/iapi/error/StandardException.html" title="class in org.apache.derby.iapi.error">StandardException</a></pre>
<div class="block">Do full upgrade.  Apply changes that can NOT be safely made in soft upgrade.
                
                <BR>
                <B>Upgrade items for every new release</B>
                <UL>
                <LI> Drop and recreate the stored versions of the JDBC database metadata queries
                </UL>
                
                <BR>
                <B>Upgrade items for 10.1</B>
                <UL>
                <LI> None.
                </UL></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>tc</code> - transaction controller</dd>
<dd><code>fromMajorVersionNumber</code> - version of the on-disk database</dd>
<dd><code>aid</code> - AuthorizationID of current user to be made Database Owner</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../../org/apache/derby/iapi/error/StandardException.html" title="class in org.apache.derby.iapi.error">StandardException</a></code> - Standard Derby error policy.</dd>
</dl>
</li>
</ul>
<a name="handleMinorRevisionChange-org.apache.derby.iapi.store.access.TransactionController-org.apache.derby.impl.sql.catalog.DD_Version-boolean-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>handleMinorRevisionChange</h4>
<pre>private&nbsp;void&nbsp;handleMinorRevisionChange(<a href="../../../../../../org/apache/derby/iapi/store/access/TransactionController.html" title="interface in org.apache.derby.iapi.store.access">TransactionController</a>&nbsp;tc,
                                       <a href="../../../../../../org/apache/derby/impl/sql/catalog/DD_Version.html" title="class in org.apache.derby.impl.sql.catalog">DD_Version</a>&nbsp;fromVersion,
                                       boolean&nbsp;softUpgradeRun)
                                throws <a href="../../../../../../org/apache/derby/iapi/error/StandardException.html" title="class in org.apache.derby.iapi.error">StandardException</a></pre>
<div class="block">Do any work needed for a minor revision change.
 For the data dictionary this is always invalidating
 stored prepared statements.  When we are done 
 with the upgrade, we always recompile all SPSes
 so the customer doesn't have to (and isn't going
 to get deadlocks because of the recomp).</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>tc</code> - the xact</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../../org/apache/derby/iapi/error/StandardException.html" title="class in org.apache.derby.iapi.error">StandardException</a></code> - Standard Derby error policy.</dd>
</dl>
</li>
</ul>
<a name="dropSystemCatalogDescription-org.apache.derby.iapi.store.access.TransactionController-org.apache.derby.iapi.sql.dictionary.TableDescriptor-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>dropSystemCatalogDescription</h4>
<pre>protected&nbsp;void&nbsp;dropSystemCatalogDescription(<a href="../../../../../../org/apache/derby/iapi/store/access/TransactionController.html" title="interface in org.apache.derby.iapi.store.access">TransactionController</a>&nbsp;tc,
                                            <a href="../../../../../../org/apache/derby/iapi/sql/dictionary/TableDescriptor.html" title="class in org.apache.derby.iapi.sql.dictionary">TableDescriptor</a>&nbsp;td)
                                     throws <a href="../../../../../../org/apache/derby/iapi/error/StandardException.html" title="class in org.apache.derby.iapi.error">StandardException</a></pre>
<div class="block">Remove the description of a System table from the data dictionary.
          This does not delete the conglomerates that hold the catalog or
          its indexes.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>tc</code> - TransactionController</dd>
<dd><code>td</code> - Table descriptor for the catalog to drop.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../../org/apache/derby/iapi/error/StandardException.html" title="class in org.apache.derby.iapi.error">StandardException</a></code> - Standard Derby error policy.</dd>
</dl>
</li>
</ul>
<a name="dropSystemCatalog-org.apache.derby.iapi.store.access.TransactionController-org.apache.derby.iapi.sql.dictionary.CatalogRowFactory-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>dropSystemCatalog</h4>
<pre>protected&nbsp;void&nbsp;dropSystemCatalog(<a href="../../../../../../org/apache/derby/iapi/store/access/TransactionController.html" title="interface in org.apache.derby.iapi.store.access">TransactionController</a>&nbsp;tc,
                                 <a href="../../../../../../org/apache/derby/iapi/sql/dictionary/CatalogRowFactory.html" title="class in org.apache.derby.iapi.sql.dictionary">CatalogRowFactory</a>&nbsp;crf)
                          throws <a href="../../../../../../org/apache/derby/iapi/error/StandardException.html" title="class in org.apache.derby.iapi.error">StandardException</a></pre>
<div class="block">Drop a System catalog.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>tc</code> - TransactionController</dd>
<dd><code>crf</code> - CatalogRowFactory for the catalog to drop.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../../org/apache/derby/iapi/error/StandardException.html" title="class in org.apache.derby.iapi.error">StandardException</a></code> - Standard Derby error policy.</dd>
</dl>
</li>
</ul>
<a name="getTypeFormatId--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getTypeFormatId</h4>
<pre>public&nbsp;int&nbsp;getTypeFormatId()</pre>
<div class="block">Get the formatID which corresponds to this class.
           Map to the 5.0 version identifier so that 5.0 will understand
           this object when we write it out in soft upgrade mode.
           CS 5.0 will de-serialize it correctly.
           When we are writing out a 5.1 version number we write out
           the 5.1 version just to ensure no problems.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../../../../../org/apache/derby/iapi/services/io/TypedFormat.html#getTypeFormatId--">getTypeFormatId</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../../../org/apache/derby/iapi/services/io/TypedFormat.html" title="interface in org.apache.derby.iapi.services.io">TypedFormat</a></code></dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the formatID of this class</dd>
</dl>
</li>
</ul>
<a name="readExternal-java.io.ObjectInput-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>readExternal</h4>
<pre>public final&nbsp;void&nbsp;readExternal(java.io.ObjectInput&nbsp;in)
                        throws java.io.IOException</pre>
<div class="block">Read this object from a stream of stored objects. Set
 the minor version.  Ignore the major version.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code>readExternal</code>&nbsp;in interface&nbsp;<code>java.io.Externalizable</code></dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>in</code> - read this.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code> - on error</dd>
</dl>
</li>
</ul>
<a name="writeExternal-java.io.ObjectOutput-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>writeExternal</h4>
<pre>public final&nbsp;void&nbsp;writeExternal(java.io.ObjectOutput&nbsp;out)
                         throws java.io.IOException</pre>
<div class="block">Write this object to a stream of stored objects. Write
 out the minor version which is bumped across minor release.
 Just to be safe, write out the major version too.  This
 will allow us to do versioning of a specific Version impl
 in the future.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code>writeExternal</code>&nbsp;in interface&nbsp;<code>java.io.Externalizable</code></dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>out</code> - write bytes here.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code> - on error</dd>
</dl>
</li>
</ul>
<a name="getJBMSMinorVersionNumber--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getJBMSMinorVersionNumber</h4>
<pre>private&nbsp;int&nbsp;getJBMSMinorVersionNumber()</pre>
<div class="block">Get the minor version from the JBMS product minor version/maint version.
 Bumps it up by 1 if production, or 0 if beta to ensure
 minor upgrade across beta.  Starts at 2 because of an
 old convention. We use this starting at 2 to allow soft upgrade to
 write a version of 1 with the old major number to ensure a minor upgrade
           when reverting to an old version afer a soft upgrade. E.g run with 5.0.2,
           then 5.2.1.1, then 5.0.2. Want to ensure 5.0.2 does the minor upgrade.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the minor version

                For 5.0 and 5.1 the minor number was calculated as

                jbmsVersion.getMinorVersion()*100 +jbmsVersion.getMaintVersion() + (jbmsVersion.isBeta() ? 0 : 1) + 2

                5.0.22 =&gt; (0*100) + 22 + 2 =  24 - (5.0 has a unique major number)
                5.1.2  =&gt; (1*100) + 2 + 2  = 104 - (5.1 has a unique major number) 


                With the switch to the four part scheme in 5.2, the maint number now is in increments of one million,
                thus the above scheme could lead to duplicate numbers. Note that the major number may not change
                when the minor external release changes, e.g. 5.2 and 5.3 could share a DD_Version major number.

                5.2.1.100 =&gt; (2*100) + 1000100 + 2 = 1000302
                5.3.1.0   =&gt; (3*100) + 1000000 + 2 = 1000302</dd>
</dl>
</li>
</ul>
<a name="modifySysTableNullability-org.apache.derby.iapi.store.access.TransactionController-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>modifySysTableNullability</h4>
<pre>private&nbsp;void&nbsp;modifySysTableNullability(<a href="../../../../../../org/apache/derby/iapi/store/access/TransactionController.html" title="interface in org.apache.derby.iapi.store.access">TransactionController</a>&nbsp;tc,
                                       int&nbsp;catalogNum)
                                throws <a href="../../../../../../org/apache/derby/iapi/error/StandardException.html" title="class in org.apache.derby.iapi.error">StandardException</a></pre>
<div class="block">Modifies the nullability of the system table corresponding
 to the received catalog number.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>tc</code> - TransactionController.</dd>
<dd><code>catalogNum</code> - The catalog number corresponding
  to the table for which we will modify the nullability.
  
  OLD Cloudscape 5.1 upgrade code
  If this corresponds to SYSALIASES, then the nullability of
  the SYSALIASES.ALIASINFO column will be changed to true
  (Beetle 4430).  If this corresponds to SYSSTATEMENTS,
  the nullability of the SYSSTATEMENTS.LASTCOMPILED
  column will be changed to true.

  Derby upgrade code
  If this corresponds to SYSSTATEMENTS, then the nullability of
  the SYSSTATEMENTS.COMPILATION_SCHEMAID column will 
  be changed to true.  If this corresponds to SYSVIEWS, the nullability
  of the SYSVIEWS.COMPILATION_SCHEMAID column will be changed to true.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../../org/apache/derby/iapi/error/StandardException.html" title="class in org.apache.derby.iapi.error">StandardException</a></code> - Thrown on error</dd>
</dl>
</li>
</ul>
<a name="checkVersion-int-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>checkVersion</h4>
<pre>boolean&nbsp;checkVersion(int&nbsp;requiredMajorVersion,
                     java.lang.String&nbsp;feature)
              throws <a href="../../../../../../org/apache/derby/iapi/error/StandardException.html" title="class in org.apache.derby.iapi.error">StandardException</a></pre>
<div class="block">Check to see if a database has been upgraded to the required
                level in order to use a language feature.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>requiredMajorVersion</code> - Data Dictionary major version</dd>
<dd><code>feature</code> - Non-null to throw an error, null to return the state of the version match.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>True if the database has been upgraded to the required level, false otherwise.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../../org/apache/derby/iapi/error/StandardException.html" title="class in org.apache.derby.iapi.error">StandardException</a></code></dd>
</dl>
</li>
</ul>
<a name="isFullUpgrade-java.util.Properties-java.lang.String-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>isFullUpgrade</h4>
<pre>private static&nbsp;boolean&nbsp;isFullUpgrade(java.util.Properties&nbsp;startParams,
                                     java.lang.String&nbsp;oldVersionInfo)
                              throws <a href="../../../../../../org/apache/derby/iapi/error/StandardException.html" title="class in org.apache.derby.iapi.error">StandardException</a></pre>
<div class="block">Privileged startup. Must be private so that user code
 can't call this entry point.</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../../org/apache/derby/iapi/error/StandardException.html" title="class in org.apache.derby.iapi.error">StandardException</a></code></dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
<div class="aboutLanguage">Built on Mon 2017-07-03 23:03:59+0530, from revision Unversioned directory</div>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../../org/apache/derby/impl/sql/catalog/DataDictionaryImpl.html" title="class in org.apache.derby.impl.sql.catalog"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../../../org/apache/derby/impl/sql/catalog/DDColumnDependableFinder.html" title="class in org.apache.derby.impl.sql.catalog"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../../index.html?org/apache/derby/impl/sql/catalog/DD_Version.html" target="_top">Frames</a></li>
<li><a href="DD_Version.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>Apache Derby V10.13 Internals - <i>Copyright &copy; 2004,2016 The Apache Software Foundation. All Rights Reserved.</i></small></p>
</body>
</html>
