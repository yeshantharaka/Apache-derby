<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_66) on Mon Jul 03 23:04:43 IST 2017 -->
<title>BasicDaemon (Apache Derby V10.13 Internals)</title>
<meta name="date" content="2017-07-03">
<link rel="stylesheet" type="text/css" href="../../../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="BasicDaemon (Apache Derby V10.13 Internals)";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":10,"i1":10,"i2":9,"i3":10,"i4":10,"i5":10,"i6":10,"i7":10,"i8":10,"i9":10,"i10":10,"i11":9,"i12":10,"i13":10,"i14":10,"i15":10,"i16":10,"i17":10,"i18":10,"i19":10};
var tabs = {65535:["t0","All Methods"],1:["t1","Static Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev&nbsp;Class</li>
<li><a href="../../../../../../org/apache/derby/impl/services/daemon/IndexStatisticsDaemonImpl.html" title="class in org.apache.derby.impl.services.daemon"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../../index.html?org/apache/derby/impl/services/daemon/BasicDaemon.html" target="_top">Frames</a></li>
<li><a href="BasicDaemon.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">org.apache.derby.impl.services.daemon</div>
<h2 title="Class BasicDaemon" class="title">Class BasicDaemon</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>org.apache.derby.impl.services.daemon.BasicDaemon</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd>java.lang.Runnable, <a href="../../../../../../org/apache/derby/iapi/services/daemon/DaemonService.html" title="interface in org.apache.derby.iapi.services.daemon">DaemonService</a></dd>
</dl>
<hr>
<br>
<pre>public class <span class="typeNameLabel">BasicDaemon</span>
extends java.lang.Object
implements <a href="../../../../../../org/apache/derby/iapi/services/daemon/DaemonService.html" title="interface in org.apache.derby.iapi.services.daemon">DaemonService</a>, java.lang.Runnable</pre>
<div class="block">A BasicDaemon is a background worker thread which does asynchronous I/O and
        general clean up.  It should not be used as a general worker thread for
        parallel execution. 

        One cannot count on the order of request or count on when the daemon will
        wake up, even with serviceNow requests.  Request are not persistent and not
        recoverable, they are all lost when the system crashes or is shutdown.
        System shutdown, even orderly ones, do not wait for daemons to finish its
        work or empty its queue.  Furthermore, any Serviceable subscriptions,
        including onDemandOnly, must tolerate spurious services.  The BasicDaemon
        will setup a context manager with no context on it.  The Serviceable
        object's performWork must provide useful context on the context manager to
        do its work.  The BasicDaemon will wrap performWork call with try / catch
        block and will use the ContextManager's error handling to clean up any
        error.  The BasicDaemon will guarentee serviceNow request will not be lost
        as long as the jbms does not crash - however, if N serviceNow requests are
        made by the same client, it may only be serviced once, not N times.

        Many Serviceable object will subscribe to the same BasicDaemon.  Their
        performWork method should be well behaved - in other words, it should not
        take too long or hog too many resources or deadlock with anyone else.  And
        it cannot (should not) error out.

        The BasicDaemon implementation manages the DaemonService's data structure,
        handles subscriptions and enqueues requests, and determine the service
        schedule for its Serviceable objects.  The BasicDaemon keeps an array
        (Vector) of Serviceable subscriptions it also keeps 2 queues for clients
        that uses it for one time service - the 1st queue is for a serviceNow
        enqueue request, the 2nd queue is for non serviceNow enqueue request.

        This BasicDaemon services its clients in the following order:
        1. any subscribed client that have made a serviceNow request that has not
                                been fulfilled 
        2. serviceable clients on the 1st queue
        3. all subscribed clients that are not onDemandOnly
        4. serviceable clients 2nd queue</div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/daemon/BasicDaemon.html#awakened">awakened</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected <a href="../../../../../../org/apache/derby/iapi/services/context/ContextManager.html" title="class in org.apache.derby.iapi.services.context">ContextManager</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/daemon/BasicDaemon.html#contextMgr">contextMgr</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected <a href="../../../../../../org/apache/derby/iapi/services/context/ContextService.html" title="class in org.apache.derby.iapi.services.context">ContextService</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/daemon/BasicDaemon.html#contextService">contextService</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/daemon/BasicDaemon.html#earlyWakeupCount">earlyWakeupCount</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private java.util.List&lt;<a href="../../../../../../org/apache/derby/impl/services/daemon/ServiceRecord.html" title="class in org.apache.derby.impl.services.daemon">ServiceRecord</a>&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/daemon/BasicDaemon.html#highPQ">highPQ</a></span></code>
<div class="block">Queues for the work to be done.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/daemon/BasicDaemon.html#inPause">inPause</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/daemon/BasicDaemon.html#lastServiceTime">lastServiceTime</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/daemon/BasicDaemon.html#nextService">nextService</a></span></code>
<div class="block">which subscribed clients to service next?</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private java.util.List&lt;<a href="../../../../../../org/apache/derby/impl/services/daemon/ServiceRecord.html" title="class in org.apache.derby.impl.services.daemon">ServiceRecord</a>&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/daemon/BasicDaemon.html#normPQ">normPQ</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/daemon/BasicDaemon.html#numClients">numClients</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/daemon/BasicDaemon.html#OPTIMAL_QUEUE_SIZE">OPTIMAL_QUEUE_SIZE</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/daemon/BasicDaemon.html#running">running</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/daemon/BasicDaemon.html#stopped">stopped</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/daemon/BasicDaemon.html#stopRequested">stopRequested</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private java.util.Vector&lt;<a href="../../../../../../org/apache/derby/impl/services/daemon/ServiceRecord.html" title="class in org.apache.derby.impl.services.daemon">ServiceRecord</a>&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/daemon/BasicDaemon.html#subscription">subscription</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/daemon/BasicDaemon.html#waiting">waiting</a></span></code>
<div class="block">true if I'm waiting, if this is false then I am running and a notify is not required.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="fields.inherited.from.class.org.apache.derby.iapi.services.daemon.DaemonService">
<!--   -->
</a>
<h3>Fields inherited from interface&nbsp;org.apache.derby.iapi.services.daemon.<a href="../../../../../../org/apache/derby/iapi/services/daemon/DaemonService.html" title="interface in org.apache.derby.iapi.services.daemon">DaemonService</a></h3>
<code><a href="../../../../../../org/apache/derby/iapi/services/daemon/DaemonService.html#DaemonOff">DaemonOff</a>, <a href="../../../../../../org/apache/derby/iapi/services/daemon/DaemonService.html#DaemonTrace">DaemonTrace</a>, <a href="../../../../../../org/apache/derby/iapi/services/daemon/DaemonService.html#TIMER_DELAY">TIMER_DELAY</a></code></li>
</ul>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/daemon/BasicDaemon.html#BasicDaemon-org.apache.derby.iapi.services.context.ContextService-">BasicDaemon</a></span>(<a href="../../../../../../org/apache/derby/iapi/services/context/ContextService.html" title="class in org.apache.derby.iapi.services.context">ContextService</a>&nbsp;contextService)</code>
<div class="block">make a BasicDaemon</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t1" class="tableTab"><span><a href="javascript:show(1);">Static Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/daemon/BasicDaemon.html#clear--">clear</a></span>()</code>
<div class="block">Get rid of all queued up Serviceable tasks.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/daemon/BasicDaemon.html#enqueue-org.apache.derby.iapi.services.daemon.Serviceable-boolean-">enqueue</a></span>(<a href="../../../../../../org/apache/derby/iapi/services/daemon/Serviceable.html" title="interface in org.apache.derby.iapi.services.daemon">Serviceable</a>&nbsp;newClient,
       boolean&nbsp;serviceNow)</code>
<div class="block">Request a one time service from the Daemon.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>(package private) static <a href="../../../../../../org/apache/derby/iapi/services/monitor/ModuleFactory.html" title="interface in org.apache.derby.iapi.services.monitor">ModuleFactory</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/daemon/BasicDaemon.html#getMonitor--">getMonitor</a></span>()</code>
<div class="block">Privileged Monitor lookup.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>private boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/daemon/BasicDaemon.html#inPause--">inPause</a></span>()</code>&nbsp;</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>protected <a href="../../../../../../org/apache/derby/impl/services/daemon/ServiceRecord.html" title="class in org.apache.derby.impl.services.daemon">ServiceRecord</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/daemon/BasicDaemon.html#nextAssignment-boolean-">nextAssignment</a></span>(boolean&nbsp;urgent)</code>&nbsp;</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/daemon/BasicDaemon.html#pause--">pause</a></span>()</code>
<div class="block">Pause.</div>
</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code>private boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/daemon/BasicDaemon.html#rest--">rest</a></span>()</code>
<div class="block">Returns true if awakened by some notification, false if wake up by timer</div>
</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/daemon/BasicDaemon.html#resume--">resume</a></span>()</code>
<div class="block">Resume service after a pause</div>
</td>
</tr>
<tr id="i8" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/daemon/BasicDaemon.html#run--">run</a></span>()</code>&nbsp;</td>
</tr>
<tr id="i9" class="rowColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/daemon/BasicDaemon.html#serviceClient-org.apache.derby.impl.services.daemon.ServiceRecord-">serviceClient</a></span>(<a href="../../../../../../org/apache/derby/impl/services/daemon/ServiceRecord.html" title="class in org.apache.derby.impl.services.daemon">ServiceRecord</a>&nbsp;clientRecord)</code>&nbsp;</td>
</tr>
<tr id="i10" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/daemon/BasicDaemon.html#serviceNow-int-">serviceNow</a></span>(int&nbsp;clientNumber)</code>
<div class="block">Service this subscription ASAP.</div>
</td>
</tr>
<tr id="i11" class="rowColor">
<td class="colFirst"><code>private static void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/daemon/BasicDaemon.html#setThreadPriority-org.apache.derby.iapi.services.monitor.ModuleFactory-int-">setThreadPriority</a></span>(<a href="../../../../../../org/apache/derby/iapi/services/monitor/ModuleFactory.html" title="interface in org.apache.derby.iapi.services.monitor">ModuleFactory</a>&nbsp;mf,
                 int&nbsp;priority)</code>
<div class="block">Change the priority of the current thread, but only if it was created
 by <a href="../../../../../../org/apache/derby/iapi/services/monitor/ModuleFactory.html#getDaemonThread-java.lang.Runnable-java.lang.String-boolean-"><code>ModuleFactory.getDaemonThread(java.lang.Runnable, java.lang.String, boolean)</code></a>.</div>
</td>
</tr>
<tr id="i12" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/daemon/BasicDaemon.html#stop--">stop</a></span>()</code>
<div class="block">Finish what we are doing and at the next convenient moment, get rid of
                the thread and make the daemon object goes away if possible.</div>
</td>
</tr>
<tr id="i13" class="rowColor">
<td class="colFirst"><code>private boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/daemon/BasicDaemon.html#stopRequested--">stopRequested</a></span>()</code>&nbsp;</td>
</tr>
<tr id="i14" class="altColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/daemon/BasicDaemon.html#subscribe-org.apache.derby.iapi.services.daemon.Serviceable-boolean-">subscribe</a></span>(<a href="../../../../../../org/apache/derby/iapi/services/daemon/Serviceable.html" title="interface in org.apache.derby.iapi.services.daemon">Serviceable</a>&nbsp;newClient,
         boolean&nbsp;onDemandOnly)</code>
<div class="block">Add a new client that this daemon needs to service</div>
</td>
</tr>
<tr id="i15" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/daemon/BasicDaemon.html#unsubscribe-int-">unsubscribe</a></span>(int&nbsp;clientNumber)</code>
<div class="block">Removes a client from the list of subscribed clients.</div>
</td>
</tr>
<tr id="i16" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/daemon/BasicDaemon.html#waitUntilQueueIsEmpty--">waitUntilQueueIsEmpty</a></span>()</code>&nbsp;</td>
</tr>
<tr id="i17" class="rowColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/daemon/BasicDaemon.html#wakeUp--">wakeUp</a></span>()</code>&nbsp;</td>
</tr>
<tr id="i18" class="altColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/daemon/BasicDaemon.html#work-boolean-">work</a></span>(boolean&nbsp;urgentOnly)</code>&nbsp;</td>
</tr>
<tr id="i19" class="rowColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/daemon/BasicDaemon.html#yield--">yield</a></span>()</code>&nbsp;</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="numClients">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>numClients</h4>
<pre>private&nbsp;int numClients</pre>
</li>
</ul>
<a name="OPTIMAL_QUEUE_SIZE">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>OPTIMAL_QUEUE_SIZE</h4>
<pre>private static final&nbsp;int OPTIMAL_QUEUE_SIZE</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../../constant-values.html#org.apache.derby.impl.services.daemon.BasicDaemon.OPTIMAL_QUEUE_SIZE">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="subscription">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>subscription</h4>
<pre>private final&nbsp;java.util.Vector&lt;<a href="../../../../../../org/apache/derby/impl/services/daemon/ServiceRecord.html" title="class in org.apache.derby.impl.services.daemon">ServiceRecord</a>&gt; subscription</pre>
</li>
</ul>
<a name="contextService">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>contextService</h4>
<pre>protected final&nbsp;<a href="../../../../../../org/apache/derby/iapi/services/context/ContextService.html" title="class in org.apache.derby.iapi.services.context">ContextService</a> contextService</pre>
</li>
</ul>
<a name="contextMgr">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>contextMgr</h4>
<pre>protected final&nbsp;<a href="../../../../../../org/apache/derby/iapi/services/context/ContextManager.html" title="class in org.apache.derby.iapi.services.context">ContextManager</a> contextMgr</pre>
</li>
</ul>
<a name="highPQ">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>highPQ</h4>
<pre>private final&nbsp;java.util.List&lt;<a href="../../../../../../org/apache/derby/impl/services/daemon/ServiceRecord.html" title="class in org.apache.derby.impl.services.daemon">ServiceRecord</a>&gt; highPQ</pre>
<div class="block">Queues for the work to be done.
                These are synchronized by this object.</div>
</li>
</ul>
<a name="normPQ">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>normPQ</h4>
<pre>private final&nbsp;java.util.List&lt;<a href="../../../../../../org/apache/derby/impl/services/daemon/ServiceRecord.html" title="class in org.apache.derby.impl.services.daemon">ServiceRecord</a>&gt; normPQ</pre>
</li>
</ul>
<a name="nextService">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>nextService</h4>
<pre>private&nbsp;int nextService</pre>
<div class="block">which subscribed clients to service next?
                only accessed by daemon thread</div>
</li>
</ul>
<a name="awakened">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>awakened</h4>
<pre>private&nbsp;boolean awakened</pre>
</li>
</ul>
<a name="waiting">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>waiting</h4>
<pre>private&nbsp;boolean waiting</pre>
<div class="block">true if I'm waiting, if this is false then I am running and a notify is not required.</div>
</li>
</ul>
<a name="inPause">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>inPause</h4>
<pre>private&nbsp;boolean inPause</pre>
</li>
</ul>
<a name="running">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>running</h4>
<pre>private&nbsp;boolean running</pre>
</li>
</ul>
<a name="stopRequested">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>stopRequested</h4>
<pre>private&nbsp;boolean stopRequested</pre>
</li>
</ul>
<a name="stopped">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>stopped</h4>
<pre>private&nbsp;boolean stopped</pre>
</li>
</ul>
<a name="lastServiceTime">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>lastServiceTime</h4>
<pre>private&nbsp;long lastServiceTime</pre>
</li>
</ul>
<a name="earlyWakeupCount">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>earlyWakeupCount</h4>
<pre>private&nbsp;int earlyWakeupCount</pre>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="BasicDaemon-org.apache.derby.iapi.services.context.ContextService-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>BasicDaemon</h4>
<pre>public&nbsp;BasicDaemon(<a href="../../../../../../org/apache/derby/iapi/services/context/ContextService.html" title="class in org.apache.derby.iapi.services.context">ContextService</a>&nbsp;contextService)</pre>
<div class="block">make a BasicDaemon</div>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="subscribe-org.apache.derby.iapi.services.daemon.Serviceable-boolean-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>subscribe</h4>
<pre>public&nbsp;int&nbsp;subscribe(<a href="../../../../../../org/apache/derby/iapi/services/daemon/Serviceable.html" title="interface in org.apache.derby.iapi.services.daemon">Serviceable</a>&nbsp;newClient,
                     boolean&nbsp;onDemandOnly)</pre>
<div class="block"><span class="descfrmTypeLabel">Description copied from interface:&nbsp;<code><a href="../../../../../../org/apache/derby/iapi/services/daemon/DaemonService.html#subscribe-org.apache.derby.iapi.services.daemon.Serviceable-boolean-">DaemonService</a></code></span></div>
<div class="block">Add a new client that this daemon needs to service</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../../../../../org/apache/derby/iapi/services/daemon/DaemonService.html#subscribe-org.apache.derby.iapi.services.daemon.Serviceable-boolean-">subscribe</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../../../org/apache/derby/iapi/services/daemon/DaemonService.html" title="interface in org.apache.derby.iapi.services.daemon">DaemonService</a></code></dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>newClient</code> - a Serviceable object this daemon will service from time to time</dd>
<dd><code>onDemandOnly</code> - only service this client when it ask for service with a serviceNow request</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>a client number that uniquely identifies this client (this subscription)</dd>
</dl>
</li>
</ul>
<a name="unsubscribe-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>unsubscribe</h4>
<pre>public&nbsp;void&nbsp;unsubscribe(int&nbsp;clientNumber)</pre>
<div class="block">Removes a client from the list of subscribed clients. The call does not
 wait for the daemon to finish the work it is currently performing.
 Therefore, the client must tolerate that its <code>performWork()</code>
 method could be invoked even after the call to
 <code>unsubscribe()</code> has returned (but not more than once).</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../../../../../org/apache/derby/iapi/services/daemon/DaemonService.html#unsubscribe-int-">unsubscribe</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../../../org/apache/derby/iapi/services/daemon/DaemonService.html" title="interface in org.apache.derby.iapi.services.daemon">DaemonService</a></code></dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>clientNumber</code> - client identifier</dd>
</dl>
</li>
</ul>
<a name="serviceNow-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>serviceNow</h4>
<pre>public&nbsp;void&nbsp;serviceNow(int&nbsp;clientNumber)</pre>
<div class="block"><span class="descfrmTypeLabel">Description copied from interface:&nbsp;<code><a href="../../../../../../org/apache/derby/iapi/services/daemon/DaemonService.html#serviceNow-int-">DaemonService</a></code></span></div>
<div class="block">Service this subscription ASAP. When this method is called, the
 subscriber's <code>performWork()</code> method is guaranteed to be
 invoked at some point in the future. However, there is no guarantee that
 a subscriber's <code>performWork()</code> is called the same number of
 times as the subscriber calls this method. More precisely, if a
 subscriber is waiting for this daemon service to invoke its
 <code>performWork()</code> method, the daemon service may, but is not
 required to, ignore requests from that subscriber until the
 <code>performWork()</code> method has been invoked.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../../../../../org/apache/derby/iapi/services/daemon/DaemonService.html#serviceNow-int-">serviceNow</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../../../org/apache/derby/iapi/services/daemon/DaemonService.html" title="interface in org.apache.derby.iapi.services.daemon">DaemonService</a></code></dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>clientNumber</code> - the number that uniquely identifies the client</dd>
</dl>
</li>
</ul>
<a name="enqueue-org.apache.derby.iapi.services.daemon.Serviceable-boolean-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>enqueue</h4>
<pre>public&nbsp;boolean&nbsp;enqueue(<a href="../../../../../../org/apache/derby/iapi/services/daemon/Serviceable.html" title="interface in org.apache.derby.iapi.services.daemon">Serviceable</a>&nbsp;newClient,
                       boolean&nbsp;serviceNow)</pre>
<div class="block"><span class="descfrmTypeLabel">Description copied from interface:&nbsp;<code><a href="../../../../../../org/apache/derby/iapi/services/daemon/DaemonService.html#enqueue-org.apache.derby.iapi.services.daemon.Serviceable-boolean-">DaemonService</a></code></span></div>
<div class="block">Request a one time service from the Daemon.  Unless performWork returns
                REQUEUE (see Serviceable), the daemon will service this client once
                and then it will get rid of this client.  Since no client number is
                associated with this client, it cannot request to be serviced or be
                unsubscribed. 

                The work is always added to the deamon, regardless of the
                state it returns.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../../../../../org/apache/derby/iapi/services/daemon/DaemonService.html#enqueue-org.apache.derby.iapi.services.daemon.Serviceable-boolean-">enqueue</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../../../org/apache/derby/iapi/services/daemon/DaemonService.html" title="interface in org.apache.derby.iapi.services.daemon">DaemonService</a></code></dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>newClient</code> - the object that needs a one time service</dd>
<dd><code>serviceNow</code> - if true, this client should be serviced ASAP, as if a
                serviceNow has been issued.  If false, then this client will be
                serviced with the normal scheduled.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>true if the daemon indicates it is being overloaded,
                false it's happy.</dd>
</dl>
</li>
</ul>
<a name="clear--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>clear</h4>
<pre>public&nbsp;void&nbsp;clear()</pre>
<div class="block">Get rid of all queued up Serviceable tasks.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../../../../../org/apache/derby/iapi/services/daemon/DaemonService.html#clear--">clear</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../../../org/apache/derby/iapi/services/daemon/DaemonService.html" title="interface in org.apache.derby.iapi.services.daemon">DaemonService</a></code></dd>
</dl>
</li>
</ul>
<a name="nextAssignment-boolean-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>nextAssignment</h4>
<pre>protected&nbsp;<a href="../../../../../../org/apache/derby/impl/services/daemon/ServiceRecord.html" title="class in org.apache.derby.impl.services.daemon">ServiceRecord</a>&nbsp;nextAssignment(boolean&nbsp;urgent)</pre>
</li>
</ul>
<a name="serviceClient-org.apache.derby.impl.services.daemon.ServiceRecord-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>serviceClient</h4>
<pre>protected&nbsp;void&nbsp;serviceClient(<a href="../../../../../../org/apache/derby/impl/services/daemon/ServiceRecord.html" title="class in org.apache.derby.impl.services.daemon">ServiceRecord</a>&nbsp;clientRecord)</pre>
</li>
</ul>
<a name="run--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>run</h4>
<pre>public&nbsp;void&nbsp;run()</pre>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code>run</code>&nbsp;in interface&nbsp;<code>java.lang.Runnable</code></dd>
</dl>
</li>
</ul>
<a name="pause--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>pause</h4>
<pre>public&nbsp;void&nbsp;pause()</pre>
<div class="block"><span class="descfrmTypeLabel">Description copied from interface:&nbsp;<code><a href="../../../../../../org/apache/derby/iapi/services/daemon/DaemonService.html#pause--">DaemonService</a></code></span></div>
<div class="block">Pause.  No new service is performed until a resume is issued.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../../../../../org/apache/derby/iapi/services/daemon/DaemonService.html#pause--">pause</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../../../org/apache/derby/iapi/services/daemon/DaemonService.html" title="interface in org.apache.derby.iapi.services.daemon">DaemonService</a></code></dd>
</dl>
</li>
</ul>
<a name="resume--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>resume</h4>
<pre>public&nbsp;void&nbsp;resume()</pre>
<div class="block"><span class="descfrmTypeLabel">Description copied from interface:&nbsp;<code><a href="../../../../../../org/apache/derby/iapi/services/daemon/DaemonService.html#resume--">DaemonService</a></code></span></div>
<div class="block">Resume service after a pause</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../../../../../org/apache/derby/iapi/services/daemon/DaemonService.html#resume--">resume</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../../../org/apache/derby/iapi/services/daemon/DaemonService.html" title="interface in org.apache.derby.iapi.services.daemon">DaemonService</a></code></dd>
</dl>
</li>
</ul>
<a name="stop--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>stop</h4>
<pre>public&nbsp;void&nbsp;stop()</pre>
<div class="block">Finish what we are doing and at the next convenient moment, get rid of
                the thread and make the daemon object goes away if possible.

                remember we are calling from another thread</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../../../../../org/apache/derby/iapi/services/daemon/DaemonService.html#stop--">stop</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../../../org/apache/derby/iapi/services/daemon/DaemonService.html" title="interface in org.apache.derby.iapi.services.daemon">DaemonService</a></code></dd>
</dl>
</li>
</ul>
<a name="waitUntilQueueIsEmpty--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>waitUntilQueueIsEmpty</h4>
<pre>public&nbsp;void&nbsp;waitUntilQueueIsEmpty()</pre>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../../../../../org/apache/derby/iapi/services/daemon/DaemonService.html#waitUntilQueueIsEmpty--">waitUntilQueueIsEmpty</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../../../org/apache/derby/iapi/services/daemon/DaemonService.html" title="interface in org.apache.derby.iapi.services.daemon">DaemonService</a></code></dd>
</dl>
</li>
</ul>
<a name="stopRequested--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>stopRequested</h4>
<pre>private&nbsp;boolean&nbsp;stopRequested()</pre>
</li>
</ul>
<a name="inPause--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>inPause</h4>
<pre>private&nbsp;boolean&nbsp;inPause()</pre>
</li>
</ul>
<a name="wakeUp--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>wakeUp</h4>
<pre>protected&nbsp;void&nbsp;wakeUp()</pre>
</li>
</ul>
<a name="rest--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>rest</h4>
<pre>private&nbsp;boolean&nbsp;rest()</pre>
<div class="block">Returns true if awakened by some notification, false if wake up by timer</div>
</li>
</ul>
<a name="work-boolean-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>work</h4>
<pre>private&nbsp;void&nbsp;work(boolean&nbsp;urgentOnly)</pre>
</li>
</ul>
<a name="yield--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>yield</h4>
<pre>private&nbsp;void&nbsp;yield()</pre>
</li>
</ul>
<a name="setThreadPriority-org.apache.derby.iapi.services.monitor.ModuleFactory-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setThreadPriority</h4>
<pre>private static&nbsp;void&nbsp;setThreadPriority(<a href="../../../../../../org/apache/derby/iapi/services/monitor/ModuleFactory.html" title="interface in org.apache.derby.iapi.services.monitor">ModuleFactory</a>&nbsp;mf,
                                      int&nbsp;priority)</pre>
<div class="block">Change the priority of the current thread, but only if it was created
 by <a href="../../../../../../org/apache/derby/iapi/services/monitor/ModuleFactory.html#getDaemonThread-java.lang.Runnable-java.lang.String-boolean-"><code>ModuleFactory.getDaemonThread(java.lang.Runnable, java.lang.String, boolean)</code></a>.</div>
</li>
</ul>
<a name="getMonitor--">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>getMonitor</h4>
<pre>static&nbsp;<a href="../../../../../../org/apache/derby/iapi/services/monitor/ModuleFactory.html" title="interface in org.apache.derby.iapi.services.monitor">ModuleFactory</a>&nbsp;getMonitor()</pre>
<div class="block">Privileged Monitor lookup. Must be package private so that user code
 can't call this entry point.</div>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
<div class="aboutLanguage">Built on Mon 2017-07-03 23:03:59+0530, from revision Unversioned directory</div>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev&nbsp;Class</li>
<li><a href="../../../../../../org/apache/derby/impl/services/daemon/IndexStatisticsDaemonImpl.html" title="class in org.apache.derby.impl.services.daemon"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../../index.html?org/apache/derby/impl/services/daemon/BasicDaemon.html" target="_top">Frames</a></li>
<li><a href="BasicDaemon.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>Apache Derby V10.13 Internals - <i>Copyright &copy; 2004,2016 The Apache Software Foundation. All Rights Reserved.</i></small></p>
</body>
</html>
