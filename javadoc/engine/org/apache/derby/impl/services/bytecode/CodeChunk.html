<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_66) on Mon Jul 03 23:04:42 IST 2017 -->
<title>CodeChunk (Apache Derby V10.13 Internals)</title>
<meta name="date" content="2017-07-03">
<link rel="stylesheet" type="text/css" href="../../../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="CodeChunk (Apache Derby V10.13 Internals)";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":10,"i1":10,"i2":10,"i3":10,"i4":10,"i5":10,"i6":10,"i7":10,"i8":10,"i9":10,"i10":10,"i11":9,"i12":10,"i13":10,"i14":10,"i15":10,"i16":10,"i17":10,"i18":10,"i19":9,"i20":9,"i21":10,"i22":9,"i23":10,"i24":10,"i25":10,"i26":9,"i27":10,"i28":10,"i29":10,"i30":10};
var tabs = {65535:["t0","All Methods"],1:["t1","Static Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../../org/apache/derby/impl/services/bytecode/BCMethodDescriptor.html" title="class in org.apache.derby.impl.services.bytecode"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../../../org/apache/derby/impl/services/bytecode/Conditional.html" title="class in org.apache.derby.impl.services.bytecode"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../../index.html?org/apache/derby/impl/services/bytecode/CodeChunk.html" target="_top">Frames</a></li>
<li><a href="CodeChunk.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">org.apache.derby.impl.services.bytecode</div>
<h2 title="Class CodeChunk" class="title">Class CodeChunk</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>org.apache.derby.impl.services.bytecode.CodeChunk</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>final class <span class="typeNameLabel">CodeChunk</span>
extends java.lang.Object</pre>
<div class="block">This class represents a chunk of code in a CodeAttribute.
 Typically, a CodeAttribute represents the code in a method.
 If there is a try/catch block, each catch block will get its
 own code chunk.  This allows the catch blocks to all be put at
 the end of the generated code for a method, which eliminates
 the need to generate a jump around each catch block, which
 would be a forward reference.</div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>(package private) static short[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/bytecode/CodeChunk.html#ARRAY_ACCESS">ARRAY_ACCESS</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) static short[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/bytecode/CodeChunk.html#ARRAY_STORE">ARRAY_STORE</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>(package private) static short[][][]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/bytecode/CodeChunk.html#CAST_CONVERSION_INFO">CAST_CONVERSION_INFO</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) <a href="../../../../../../org/apache/derby/impl/services/bytecode/BCClass.html" title="class in org.apache.derby.impl.services.bytecode">BCClass</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/bytecode/CodeChunk.html#cb">cb</a></span></code>
<div class="block">The class we are generating code for, used to indicate that
 some limit was hit during code generation.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/bytecode/CodeChunk.html#CODE_OFFSET">CODE_OFFSET</a></span></code>
<div class="block">Starting point of the byte code stream in the underlying stream/array.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private <a href="../../../../../../org/apache/derby/iapi/services/classfile/ClassFormatOutput.html" title="class in org.apache.derby.iapi.services.classfile">ClassFormatOutput</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/bytecode/CodeChunk.html#cout">cout</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>(package private) static short[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/bytecode/CodeChunk.html#LOAD_VARIABLE">LOAD_VARIABLE</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) static short[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/bytecode/CodeChunk.html#LOAD_VARIABLE_FAST">LOAD_VARIABLE_FAST</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static byte[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/bytecode/CodeChunk.html#NS">NS</a></span></code>
<div class="block">Constant used by OPCODE_ACTION to the opcode is
 not yet supported.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static byte[][]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/bytecode/CodeChunk.html#OPCODE_ACTION">OPCODE_ACTION</a></span></code>
<div class="block">Array that provides two pieces of information about
 each VM opcode.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/bytecode/CodeChunk.html#pcDelta">pcDelta</a></span></code>
<div class="block">The delta between cout.size() and the pc.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static byte[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/bytecode/CodeChunk.html#push1_1i">push1_1i</a></span></code>
<div class="block">Constant used by OPCODE_ACTION to represent the
 common action of push one word, 1 byte
 for the instruction.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static byte[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/bytecode/CodeChunk.html#push2_1i">push2_1i</a></span></code>
<div class="block">Constant used by OPCODE_ACTION to represent the
 common action of push two words, 1 byte
 for the instruction.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) static short[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/bytecode/CodeChunk.html#RETURN_OPCODE">RETURN_OPCODE</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>(package private) static short[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/bytecode/CodeChunk.html#STORE_VARIABLE">STORE_VARIABLE</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) static short[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/bytecode/CodeChunk.html#STORE_VARIABLE_FAST">STORE_VARIABLE_FAST</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static byte</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/bytecode/CodeChunk.html#VARIABLE_STACK">VARIABLE_STACK</a></span></code>
<div class="block">Value for OPCODE_ACTION[opcode][0] to represent
 the number of words popped or pushed in variable.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier</th>
<th class="colLast" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>(package private)</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/bytecode/CodeChunk.html#CodeChunk-org.apache.derby.impl.services.bytecode.BCClass-">CodeChunk</a></span>(<a href="../../../../../../org/apache/derby/impl/services/bytecode/BCClass.html" title="class in org.apache.derby.impl.services.bytecode">BCClass</a>&nbsp;cb)</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private </code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/bytecode/CodeChunk.html#CodeChunk-org.apache.derby.impl.services.bytecode.CodeChunk-int-int-">CodeChunk</a></span>(<a href="../../../../../../org/apache/derby/impl/services/bytecode/CodeChunk.html" title="class in org.apache.derby.impl.services.bytecode">CodeChunk</a>&nbsp;main,
         int&nbsp;pc,
         int&nbsp;byteCount)</code>
<div class="block">Return a CodeChunk that has limited visibility into
 this CodeChunk.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t1" class="tableTab"><span><a href="javascript:show(1);">Static Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>(package private) void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/bytecode/CodeChunk.html#addInstr-short-">addInstr</a></span>(short&nbsp;opcode)</code>
<div class="block">Add an instruction that has no operand.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>(package private) void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/bytecode/CodeChunk.html#addInstrCPE-short-int-">addInstrCPE</a></span>(short&nbsp;opcode,
           int&nbsp;cpeNum)</code>
<div class="block">This takes an instruction that has a narrow
 and a wide form for CPE access, and
 generates accordingly the right one.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>(package private) void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/bytecode/CodeChunk.html#addInstrU1-short-int-">addInstrU1</a></span>(short&nbsp;opcode,
          int&nbsp;operand)</code>
<div class="block">Add an instruction that has an 8 bit operand.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>(package private) void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/bytecode/CodeChunk.html#addInstrU2-short-int-">addInstrU2</a></span>(short&nbsp;opcode,
          int&nbsp;operand)</code>
<div class="block">Add an instruction that has a 16 bit operand.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>(package private) void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/bytecode/CodeChunk.html#addInstrU2U1U1-short-int-short-short-">addInstrU2U1U1</a></span>(short&nbsp;opcode,
              int&nbsp;operand1,
              short&nbsp;operand2,
              short&nbsp;operand3)</code>
<div class="block">For adding an instruction with 3 operands, a U2 and two U1's.</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>(package private) void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/bytecode/CodeChunk.html#addInstrU4-short-int-">addInstrU4</a></span>(short&nbsp;opcode,
          int&nbsp;operand)</code>
<div class="block">Add an instruction that has a 32 bit operand.</div>
</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code>(package private) void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/bytecode/CodeChunk.html#addInstrWide-short-int-">addInstrWide</a></span>(short&nbsp;opcode,
            int&nbsp;varNum)</code>
<div class="block">This takes an instruction that can be wrapped in
 a wide for large variable #s and does so.</div>
</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code>(package private) void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/bytecode/CodeChunk.html#complete-org.apache.derby.impl.services.bytecode.BCMethod-org.apache.derby.iapi.services.classfile.ClassHolder-org.apache.derby.iapi.services.classfile.ClassMember-int-int-">complete</a></span>(<a href="../../../../../../org/apache/derby/impl/services/bytecode/BCMethod.html" title="class in org.apache.derby.impl.services.bytecode">BCMethod</a>&nbsp;mb,
        <a href="../../../../../../org/apache/derby/iapi/services/classfile/ClassHolder.html" title="class in org.apache.derby.iapi.services.classfile">ClassHolder</a>&nbsp;ch,
        <a href="../../../../../../org/apache/derby/iapi/services/classfile/ClassMember.html" title="class in org.apache.derby.iapi.services.classfile">ClassMember</a>&nbsp;method,
        int&nbsp;maxStack,
        int&nbsp;maxLocals)</code>
<div class="block">wrap up the entry and stuff it in the class,
 now that it holds all of the instructions and
 the exception table.</div>
</td>
</tr>
<tr id="i8" class="altColor">
<td class="colFirst"><code>private int[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/bytecode/CodeChunk.html#findConditionalPCs-int-short-">findConditionalPCs</a></span>(int&nbsp;pc,
                  short&nbsp;opcode)</code>
<div class="block">Find the limits of a conditional block starting at the instruction with
 the given opcode at the program counter pc.</div>
</td>
</tr>
<tr id="i9" class="rowColor">
<td class="colFirst"><code>private int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/bytecode/CodeChunk.html#findMaxStack-org.apache.derby.iapi.services.classfile.ClassHolder-int-int-">findMaxStack</a></span>(<a href="../../../../../../org/apache/derby/iapi/services/classfile/ClassHolder.html" title="class in org.apache.derby.iapi.services.classfile">ClassHolder</a>&nbsp;ch,
            int&nbsp;pc,
            int&nbsp;codeLength)</code>
<div class="block">For a block of byte code starting at program counter pc for codeLength
 bytes return the maximum stack value, assuming a initial stack depth of
 zero.</div>
</td>
</tr>
<tr id="i10" class="altColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/bytecode/CodeChunk.html#fixLengths-org.apache.derby.impl.services.bytecode.BCMethod-int-int-int-">fixLengths</a></span>(<a href="../../../../../../org/apache/derby/impl/services/bytecode/BCMethod.html" title="class in org.apache.derby.impl.services.bytecode">BCMethod</a>&nbsp;mb,
          int&nbsp;maxStack,
          int&nbsp;maxLocals,
          int&nbsp;codeLength)</code>
<div class="block">now that we have codeBytes, fix the lengths fields in it
 to reflect what was stored.</div>
</td>
</tr>
<tr id="i11" class="rowColor">
<td class="colFirst"><code>private static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/bytecode/CodeChunk.html#getDescriptorWordCount-java.lang.String-">getDescriptorWordCount</a></span>(java.lang.String&nbsp;vmDescriptor)</code>
<div class="block">Get the word count for a type descriptor in the format of the virual
 machine.</div>
</td>
</tr>
<tr id="i12" class="altColor">
<td class="colFirst"><code>(package private) short</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/bytecode/CodeChunk.html#getOpcode-int-">getOpcode</a></span>(int&nbsp;pc)</code>
<div class="block">Return the opcode at the given pc.</div>
</td>
</tr>
<tr id="i13" class="rowColor">
<td class="colFirst"><code>(package private) int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/bytecode/CodeChunk.html#getPC--">getPC</a></span>()</code>
<div class="block">Get the current program counter</div>
</td>
</tr>
<tr id="i14" class="altColor">
<td class="colFirst"><code>private java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/bytecode/CodeChunk.html#getTypeDescriptor-org.apache.derby.iapi.services.classfile.ClassHolder-int-">getTypeDescriptor</a></span>(<a href="../../../../../../org/apache/derby/iapi/services/classfile/ClassHolder.html" title="class in org.apache.derby.iapi.services.classfile">ClassHolder</a>&nbsp;ch,
                 int&nbsp;pc)</code>
<div class="block">Get the type descriptor in the virtual machine format for the type
 defined by the constant pool index for the instruction at pc.</div>
</td>
</tr>
<tr id="i15" class="rowColor">
<td class="colFirst"><code>private int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/bytecode/CodeChunk.html#getU2-int-">getU2</a></span>(int&nbsp;pc)</code>
<div class="block">Get the unsigned short value for the opcode at the program
 counter pc.</div>
</td>
</tr>
<tr id="i16" class="altColor">
<td class="colFirst"><code>private int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/bytecode/CodeChunk.html#getU4-int-">getU4</a></span>(int&nbsp;pc)</code>
<div class="block">Get the unsigned 32 bit value for the opcode at the program
 counter pc.</div>
</td>
</tr>
<tr id="i17" class="rowColor">
<td class="colFirst"><code>private int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/bytecode/CodeChunk.html#getVariableStackDelta-org.apache.derby.iapi.services.classfile.ClassHolder-int-int-">getVariableStackDelta</a></span>(<a href="../../../../../../org/apache/derby/iapi/services/classfile/ClassHolder.html" title="class in org.apache.derby.iapi.services.classfile">ClassHolder</a>&nbsp;ch,
                     int&nbsp;pc,
                     int&nbsp;opcode)</code>
<div class="block">Get the number of words pushed (positive) or popped (negative) by this
 instruction.</div>
</td>
</tr>
<tr id="i18" class="altColor">
<td class="colFirst"><code>(package private) <a href="../../../../../../org/apache/derby/impl/services/bytecode/CodeChunk.html" title="class in org.apache.derby.impl.services.bytecode">CodeChunk</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/bytecode/CodeChunk.html#insertCodeSpace-int-int-">insertCodeSpace</a></span>(int&nbsp;pc,
               int&nbsp;additionalBytes)</code>
<div class="block">Insert room for byteCount bytes after the instruction at pc
 and prepare to replace the instruction at pc.</div>
</td>
</tr>
<tr id="i19" class="rowColor">
<td class="colFirst"><code>private static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/bytecode/CodeChunk.html#instructionLength-short-">instructionLength</a></span>(short&nbsp;opcode)</code>
<div class="block">Return the complete instruction length for the
 passed in opcode.</div>
</td>
</tr>
<tr id="i20" class="altColor">
<td class="colFirst"><code>private static boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/bytecode/CodeChunk.html#isReturn-short-">isReturn</a></span>(short&nbsp;opcode)</code>
<div class="block">See if the opcode is a return instruction.</div>
</td>
</tr>
<tr id="i21" class="rowColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/bytecode/CodeChunk.html#limitHit-java.io.IOException-">limitHit</a></span>(java.io.IOException&nbsp;ioe)</code>
<div class="block">Assume an IOException means some limit of the class file
 format was hit</div>
</td>
</tr>
<tr id="i22" class="altColor">
<td class="colFirst"><code>private static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/bytecode/CodeChunk.html#parameterWordCount-java.lang.String-">parameterWordCount</a></span>(java.lang.String&nbsp;methodDescriptor)</code>
<div class="block">Calculate the number of stack words in the arguments pushed for this
 method descriptor.</div>
</td>
</tr>
<tr id="i23" class="rowColor">
<td class="colFirst"><code>private int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/bytecode/CodeChunk.html#removePushedCode-org.apache.derby.impl.services.bytecode.BCMethod-org.apache.derby.iapi.services.classfile.ClassHolder-org.apache.derby.impl.services.bytecode.BCMethod-int-int-">removePushedCode</a></span>(<a href="../../../../../../org/apache/derby/impl/services/bytecode/BCMethod.html" title="class in org.apache.derby.impl.services.bytecode">BCMethod</a>&nbsp;mb,
                <a href="../../../../../../org/apache/derby/iapi/services/classfile/ClassHolder.html" title="class in org.apache.derby.iapi.services.classfile">ClassHolder</a>&nbsp;ch,
                <a href="../../../../../../org/apache/derby/impl/services/bytecode/BCMethod.html" title="class in org.apache.derby.impl.services.bytecode">BCMethod</a>&nbsp;subMethod,
                int&nbsp;split_pc,
                int&nbsp;splitLength)</code>
<div class="block">Remove a block of code from this method that was pushed into a sub-method
 and call the sub-method.</div>
</td>
</tr>
<tr id="i24" class="altColor">
<td class="colFirst"><code>private int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/bytecode/CodeChunk.html#splitCodeIntoSubMethod-org.apache.derby.impl.services.bytecode.BCMethod-org.apache.derby.iapi.services.classfile.ClassHolder-org.apache.derby.impl.services.bytecode.BCMethod-int-int-">splitCodeIntoSubMethod</a></span>(<a href="../../../../../../org/apache/derby/impl/services/bytecode/BCMethod.html" title="class in org.apache.derby.impl.services.bytecode">BCMethod</a>&nbsp;mb,
                      <a href="../../../../../../org/apache/derby/iapi/services/classfile/ClassHolder.html" title="class in org.apache.derby.iapi.services.classfile">ClassHolder</a>&nbsp;ch,
                      <a href="../../../../../../org/apache/derby/impl/services/bytecode/BCMethod.html" title="class in org.apache.derby.impl.services.bytecode">BCMethod</a>&nbsp;subMethod,
                      int&nbsp;split_pc,
                      int&nbsp;splitLength)</code>
<div class="block">Split a block of code from this method into a sub-method
 and call it.</div>
</td>
</tr>
<tr id="i25" class="rowColor">
<td class="colFirst"><code>(package private) int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/bytecode/CodeChunk.html#splitExpressionOut-org.apache.derby.impl.services.bytecode.BCMethod-org.apache.derby.iapi.services.classfile.ClassHolder-int-int-">splitExpressionOut</a></span>(<a href="../../../../../../org/apache/derby/impl/services/bytecode/BCMethod.html" title="class in org.apache.derby.impl.services.bytecode">BCMethod</a>&nbsp;mb,
                  <a href="../../../../../../org/apache/derby/iapi/services/classfile/ClassHolder.html" title="class in org.apache.derby.iapi.services.classfile">ClassHolder</a>&nbsp;ch,
                  int&nbsp;optimalMinLength,
                  int&nbsp;maxStack)</code>
<div class="block">Split an expression out of a large method into its own
 sub-method.</div>
</td>
</tr>
<tr id="i26" class="altColor">
<td class="colFirst"><code>private static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/bytecode/CodeChunk.html#splitMinLength-org.apache.derby.impl.services.bytecode.BCMethod-">splitMinLength</a></span>(<a href="../../../../../../org/apache/derby/impl/services/bytecode/BCMethod.html" title="class in org.apache.derby.impl.services.bytecode">BCMethod</a>&nbsp;mb)</code>
<div class="block">Minimum split length for a sub-method.</div>
</td>
</tr>
<tr id="i27" class="rowColor">
<td class="colFirst"><code>(package private) int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/bytecode/CodeChunk.html#splitZeroStack-org.apache.derby.impl.services.bytecode.BCMethod-org.apache.derby.iapi.services.classfile.ClassHolder-int-int-">splitZeroStack</a></span>(<a href="../../../../../../org/apache/derby/impl/services/bytecode/BCMethod.html" title="class in org.apache.derby.impl.services.bytecode">BCMethod</a>&nbsp;mb,
              <a href="../../../../../../org/apache/derby/iapi/services/classfile/ClassHolder.html" title="class in org.apache.derby.iapi.services.classfile">ClassHolder</a>&nbsp;ch,
              int&nbsp;split_pc,
              int&nbsp;optimalMinLength)</code>
<div class="block">Attempt to split the current method by pushing a chunk of
 its code into a sub-method.</div>
</td>
</tr>
<tr id="i28" class="altColor">
<td class="colFirst"><code>private int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/bytecode/CodeChunk.html#stackWordDelta-org.apache.derby.iapi.services.classfile.ClassHolder-int-short-">stackWordDelta</a></span>(<a href="../../../../../../org/apache/derby/iapi/services/classfile/ClassHolder.html" title="class in org.apache.derby.iapi.services.classfile">ClassHolder</a>&nbsp;ch,
              int&nbsp;pc,
              short&nbsp;opcode)</code>
<div class="block">Return the number of stack words pushed (positive) or popped (negative)
 by this instruction.</div>
</td>
</tr>
<tr id="i29" class="rowColor">
<td class="colFirst"><code>private <a href="../../../../../../org/apache/derby/impl/services/bytecode/BCMethod.html" title="class in org.apache.derby.impl.services.bytecode">BCMethod</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/bytecode/CodeChunk.html#startSubMethod-org.apache.derby.impl.services.bytecode.BCMethod-java.lang.String-int-int-">startSubMethod</a></span>(<a href="../../../../../../org/apache/derby/impl/services/bytecode/BCMethod.html" title="class in org.apache.derby.impl.services.bytecode">BCMethod</a>&nbsp;mb,
              java.lang.String&nbsp;returnType,
              int&nbsp;split_pc,
              int&nbsp;blockLength)</code>
<div class="block">Start a sub method that we will split the portion of our current code to,
 starting from start_pc and including codeLength bytes of code.</div>
</td>
</tr>
<tr id="i30" class="altColor">
<td class="colFirst"><code>private boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/bytecode/CodeChunk.html#usesParameters-org.apache.derby.impl.services.bytecode.BCMethod-int-int-">usesParameters</a></span>(<a href="../../../../../../org/apache/derby/impl/services/bytecode/BCMethod.html" title="class in org.apache.derby.impl.services.bytecode">BCMethod</a>&nbsp;mb,
              int&nbsp;pc,
              int&nbsp;codeLength)</code>
<div class="block">Does a section of code use parameters.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="CODE_OFFSET">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>CODE_OFFSET</h4>
<pre>private static final&nbsp;int CODE_OFFSET</pre>
<div class="block">Starting point of the byte code stream in the underlying stream/array.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../../constant-values.html#org.apache.derby.impl.services.bytecode.CodeChunk.CODE_OFFSET">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="LOAD_VARIABLE">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>LOAD_VARIABLE</h4>
<pre>static final&nbsp;short[] LOAD_VARIABLE</pre>
</li>
</ul>
<a name="LOAD_VARIABLE_FAST">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>LOAD_VARIABLE_FAST</h4>
<pre>static final&nbsp;short[] LOAD_VARIABLE_FAST</pre>
</li>
</ul>
<a name="STORE_VARIABLE">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>STORE_VARIABLE</h4>
<pre>static final&nbsp;short[] STORE_VARIABLE</pre>
</li>
</ul>
<a name="STORE_VARIABLE_FAST">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>STORE_VARIABLE_FAST</h4>
<pre>static final&nbsp;short[] STORE_VARIABLE_FAST</pre>
</li>
</ul>
<a name="ARRAY_ACCESS">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>ARRAY_ACCESS</h4>
<pre>static final&nbsp;short[] ARRAY_ACCESS</pre>
</li>
</ul>
<a name="ARRAY_STORE">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>ARRAY_STORE</h4>
<pre>static final&nbsp;short[] ARRAY_STORE</pre>
</li>
</ul>
<a name="RETURN_OPCODE">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>RETURN_OPCODE</h4>
<pre>static final&nbsp;short[] RETURN_OPCODE</pre>
</li>
</ul>
<a name="CAST_CONVERSION_INFO">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>CAST_CONVERSION_INFO</h4>
<pre>static final&nbsp;short[][][] CAST_CONVERSION_INFO</pre>
</li>
</ul>
<a name="push1_1i">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>push1_1i</h4>
<pre>private static final&nbsp;byte[] push1_1i</pre>
<div class="block">Constant used by OPCODE_ACTION to represent the
 common action of push one word, 1 byte
 for the instruction.</div>
</li>
</ul>
<a name="push2_1i">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>push2_1i</h4>
<pre>private static final&nbsp;byte[] push2_1i</pre>
<div class="block">Constant used by OPCODE_ACTION to represent the
 common action of push two words, 1 byte
 for the instruction.</div>
</li>
</ul>
<a name="NS">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>NS</h4>
<pre>private static final&nbsp;byte[] NS</pre>
<div class="block">Constant used by OPCODE_ACTION to the opcode is
 not yet supported.</div>
</li>
</ul>
<a name="VARIABLE_STACK">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>VARIABLE_STACK</h4>
<pre>private static final&nbsp;byte VARIABLE_STACK</pre>
<div class="block">Value for OPCODE_ACTION[opcode][0] to represent
 the number of words popped or pushed in variable.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../../constant-values.html#org.apache.derby.impl.services.bytecode.CodeChunk.VARIABLE_STACK">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="OPCODE_ACTION">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>OPCODE_ACTION</h4>
<pre>private static final&nbsp;byte[][] OPCODE_ACTION</pre>
<div class="block">Array that provides two pieces of information about
 each VM opcode. Each opcode has a two byte array.
 <P>
 The first element in the array [0] is the number of
 stack words (double/long count as two) pushed by the opcode.
 Will be negative if the opcode pops values.
 
 <P>
 The second element in the array [1] is the number of bytes
 in the instruction stream that this opcode's instruction
 takes up, including the opocode.</div>
</li>
</ul>
<a name="pcDelta">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>pcDelta</h4>
<pre>private final&nbsp;int pcDelta</pre>
<div class="block">The delta between cout.size() and the pc.
 For an initial code chunk this is -8 (CODE_OFFSET)
 since 8 bytes are written.
 For a nested CodeChunk return by insertCodeSpace the delta
 corresponds to the original starting pc.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../../org/apache/derby/impl/services/bytecode/CodeChunk.html#insertCodeSpace-int-int-"><code>insertCodeSpace(int, int)</code></a></dd>
</dl>
</li>
</ul>
<a name="cb">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>cb</h4>
<pre>final&nbsp;<a href="../../../../../../org/apache/derby/impl/services/bytecode/BCClass.html" title="class in org.apache.derby.impl.services.bytecode">BCClass</a> cb</pre>
<div class="block">The class we are generating code for, used to indicate that
 some limit was hit during code generation.</div>
</li>
</ul>
<a name="cout">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>cout</h4>
<pre>private final&nbsp;<a href="../../../../../../org/apache/derby/iapi/services/classfile/ClassFormatOutput.html" title="class in org.apache.derby.iapi.services.classfile">ClassFormatOutput</a> cout</pre>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="CodeChunk-org.apache.derby.impl.services.bytecode.BCClass-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>CodeChunk</h4>
<pre>CodeChunk(<a href="../../../../../../org/apache/derby/impl/services/bytecode/BCClass.html" title="class in org.apache.derby.impl.services.bytecode">BCClass</a>&nbsp;cb)</pre>
</li>
</ul>
<a name="CodeChunk-org.apache.derby.impl.services.bytecode.CodeChunk-int-int-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>CodeChunk</h4>
<pre>private&nbsp;CodeChunk(<a href="../../../../../../org/apache/derby/impl/services/bytecode/CodeChunk.html" title="class in org.apache.derby.impl.services.bytecode">CodeChunk</a>&nbsp;main,
                  int&nbsp;pc,
                  int&nbsp;byteCount)</pre>
<div class="block">Return a CodeChunk that has limited visibility into
 this CodeChunk. Used when a caller needs to insert instructions
 into an existing stream.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>pc</code> - </dd>
<dd><code>byteCount</code> - </dd>
</dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="limitHit-java.io.IOException-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>limitHit</h4>
<pre>private&nbsp;void&nbsp;limitHit(java.io.IOException&nbsp;ioe)</pre>
<div class="block">Assume an IOException means some limit of the class file
 format was hit</div>
</li>
</ul>
<a name="addInstr-short-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>addInstr</h4>
<pre>void&nbsp;addInstr(short&nbsp;opcode)</pre>
<div class="block">Add an instruction that has no operand.
 All opcodes are 1 byte large.</div>
</li>
</ul>
<a name="addInstrU2-short-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>addInstrU2</h4>
<pre>void&nbsp;addInstrU2(short&nbsp;opcode,
                int&nbsp;operand)</pre>
<div class="block">Add an instruction that has a 16 bit operand.</div>
</li>
</ul>
<a name="addInstrU4-short-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>addInstrU4</h4>
<pre>void&nbsp;addInstrU4(short&nbsp;opcode,
                int&nbsp;operand)</pre>
<div class="block">Add an instruction that has a 32 bit operand.</div>
</li>
</ul>
<a name="addInstrU1-short-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>addInstrU1</h4>
<pre>void&nbsp;addInstrU1(short&nbsp;opcode,
                int&nbsp;operand)</pre>
<div class="block">Add an instruction that has an 8 bit operand.</div>
</li>
</ul>
<a name="addInstrCPE-short-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>addInstrCPE</h4>
<pre>void&nbsp;addInstrCPE(short&nbsp;opcode,
                 int&nbsp;cpeNum)</pre>
<div class="block">This takes an instruction that has a narrow
 and a wide form for CPE access, and
 generates accordingly the right one.
 We assume the narrow instruction is what
 we were given, and that the wide form is
 the next possible instruction.</div>
</li>
</ul>
<a name="addInstrWide-short-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>addInstrWide</h4>
<pre>void&nbsp;addInstrWide(short&nbsp;opcode,
                  int&nbsp;varNum)</pre>
<div class="block">This takes an instruction that can be wrapped in
 a wide for large variable #s and does so.</div>
</li>
</ul>
<a name="addInstrU2U1U1-short-int-short-short-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>addInstrU2U1U1</h4>
<pre>void&nbsp;addInstrU2U1U1(short&nbsp;opcode,
                    int&nbsp;operand1,
                    short&nbsp;operand2,
                    short&nbsp;operand3)</pre>
<div class="block">For adding an instruction with 3 operands, a U2 and two U1's.
 So far, this is used by VMOpcode.INVOKEINTERFACE.</div>
</li>
</ul>
<a name="getPC--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getPC</h4>
<pre>int&nbsp;getPC()</pre>
<div class="block">Get the current program counter</div>
</li>
</ul>
<a name="instructionLength-short-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>instructionLength</h4>
<pre>private static&nbsp;int&nbsp;instructionLength(short&nbsp;opcode)</pre>
<div class="block">Return the complete instruction length for the
 passed in opcode. This will include the space for
 the opcode and its operand.</div>
</li>
</ul>
<a name="fixLengths-org.apache.derby.impl.services.bytecode.BCMethod-int-int-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>fixLengths</h4>
<pre>private&nbsp;void&nbsp;fixLengths(<a href="../../../../../../org/apache/derby/impl/services/bytecode/BCMethod.html" title="class in org.apache.derby.impl.services.bytecode">BCMethod</a>&nbsp;mb,
                        int&nbsp;maxStack,
                        int&nbsp;maxLocals,
                        int&nbsp;codeLength)</pre>
<div class="block">now that we have codeBytes, fix the lengths fields in it
 to reflect what was stored.
 Limits checked here are from these sections of the JVM spec.
 <UL>
 <LI> 4.7.3 The Code Attribute
 <LI> 4.10 Limitations of the Java Virtual Machine 
 </UL></div>
</li>
</ul>
<a name="complete-org.apache.derby.impl.services.bytecode.BCMethod-org.apache.derby.iapi.services.classfile.ClassHolder-org.apache.derby.iapi.services.classfile.ClassMember-int-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>complete</h4>
<pre>void&nbsp;complete(<a href="../../../../../../org/apache/derby/impl/services/bytecode/BCMethod.html" title="class in org.apache.derby.impl.services.bytecode">BCMethod</a>&nbsp;mb,
              <a href="../../../../../../org/apache/derby/iapi/services/classfile/ClassHolder.html" title="class in org.apache.derby.iapi.services.classfile">ClassHolder</a>&nbsp;ch,
              <a href="../../../../../../org/apache/derby/iapi/services/classfile/ClassMember.html" title="class in org.apache.derby.iapi.services.classfile">ClassMember</a>&nbsp;method,
              int&nbsp;maxStack,
              int&nbsp;maxLocals)</pre>
<div class="block">wrap up the entry and stuff it in the class,
 now that it holds all of the instructions and
 the exception table.</div>
</li>
</ul>
<a name="getOpcode-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getOpcode</h4>
<pre>short&nbsp;getOpcode(int&nbsp;pc)</pre>
<div class="block">Return the opcode at the given pc.</div>
</li>
</ul>
<a name="getU2-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getU2</h4>
<pre>private&nbsp;int&nbsp;getU2(int&nbsp;pc)</pre>
<div class="block">Get the unsigned short value for the opcode at the program
 counter pc.</div>
</li>
</ul>
<a name="getU4-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getU4</h4>
<pre>private&nbsp;int&nbsp;getU4(int&nbsp;pc)</pre>
<div class="block">Get the unsigned 32 bit value for the opcode at the program
 counter pc.</div>
</li>
</ul>
<a name="insertCodeSpace-int-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>insertCodeSpace</h4>
<pre><a href="../../../../../../org/apache/derby/impl/services/bytecode/CodeChunk.html" title="class in org.apache.derby.impl.services.bytecode">CodeChunk</a>&nbsp;insertCodeSpace(int&nbsp;pc,
                          int&nbsp;additionalBytes)</pre>
<div class="block">Insert room for byteCount bytes after the instruction at pc
 and prepare to replace the instruction at pc. The instruction
 at pc is not modified by this call, space is allocated after it.
 The newly inserted space will be filled with NOP instructions.
 
 Returns a CodeChunk positioned at pc and available to write
 instructions upto (byteCode + length(existing instruction at pc) bytes.
 
 This chunk is left correctly positioned at the end of the code
 stream, ready to accept more code. Its pc will have increased by
 additionalBytes.
 
 It is the responsibility of the caller to patch up any
 branches or gotos.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>pc</code> - </dd>
<dd><code>additionalBytes</code> - </dd>
</dl>
</li>
</ul>
<a name="findMaxStack-org.apache.derby.iapi.services.classfile.ClassHolder-int-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>findMaxStack</h4>
<pre>private&nbsp;int&nbsp;findMaxStack(<a href="../../../../../../org/apache/derby/iapi/services/classfile/ClassHolder.html" title="class in org.apache.derby.iapi.services.classfile">ClassHolder</a>&nbsp;ch,
                         int&nbsp;pc,
                         int&nbsp;codeLength)</pre>
<div class="block">For a block of byte code starting at program counter pc for codeLength
 bytes return the maximum stack value, assuming a initial stack depth of
 zero.</div>
</li>
</ul>
<a name="stackWordDelta-org.apache.derby.iapi.services.classfile.ClassHolder-int-short-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>stackWordDelta</h4>
<pre>private&nbsp;int&nbsp;stackWordDelta(<a href="../../../../../../org/apache/derby/iapi/services/classfile/ClassHolder.html" title="class in org.apache.derby.iapi.services.classfile">ClassHolder</a>&nbsp;ch,
                           int&nbsp;pc,
                           short&nbsp;opcode)</pre>
<div class="block">Return the number of stack words pushed (positive) or popped (negative)
 by this instruction.</div>
</li>
</ul>
<a name="getTypeDescriptor-org.apache.derby.iapi.services.classfile.ClassHolder-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getTypeDescriptor</h4>
<pre>private&nbsp;java.lang.String&nbsp;getTypeDescriptor(<a href="../../../../../../org/apache/derby/iapi/services/classfile/ClassHolder.html" title="class in org.apache.derby.iapi.services.classfile">ClassHolder</a>&nbsp;ch,
                                           int&nbsp;pc)</pre>
<div class="block">Get the type descriptor in the virtual machine format for the type
 defined by the constant pool index for the instruction at pc.</div>
</li>
</ul>
<a name="getDescriptorWordCount-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getDescriptorWordCount</h4>
<pre>private static&nbsp;int&nbsp;getDescriptorWordCount(java.lang.String&nbsp;vmDescriptor)</pre>
<div class="block">Get the word count for a type descriptor in the format of the virual
 machine. For a method this returns the the word count for the return
 type.</div>
</li>
</ul>
<a name="getVariableStackDelta-org.apache.derby.iapi.services.classfile.ClassHolder-int-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getVariableStackDelta</h4>
<pre>private&nbsp;int&nbsp;getVariableStackDelta(<a href="../../../../../../org/apache/derby/iapi/services/classfile/ClassHolder.html" title="class in org.apache.derby.iapi.services.classfile">ClassHolder</a>&nbsp;ch,
                                  int&nbsp;pc,
                                  int&nbsp;opcode)</pre>
<div class="block">Get the number of words pushed (positive) or popped (negative) by this
 instruction. The instruction is a get/put field or a method call, thus
 the size of the words is defined by the field or method being access.</div>
</li>
</ul>
<a name="parameterWordCount-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>parameterWordCount</h4>
<pre>private static&nbsp;int&nbsp;parameterWordCount(java.lang.String&nbsp;methodDescriptor)</pre>
<div class="block">Calculate the number of stack words in the arguments pushed for this
 method descriptor.</div>
</li>
</ul>
<a name="findConditionalPCs-int-short-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>findConditionalPCs</h4>
<pre>private&nbsp;int[]&nbsp;findConditionalPCs(int&nbsp;pc,
                                 short&nbsp;opcode)</pre>
<div class="block">Find the limits of a conditional block starting at the instruction with
 the given opcode at the program counter pc.
 <P>
 Returns a six element integer array of program counters and lengths.
 <code> [0] - program counter of the IF opcode (passed in as pc) [1] -
 program counter of the start of the then block [2] - length of the then
 block [3] - program counter of the else block, -1 if no else block
 exists. [4] - length of of the else block, -1 if no else block exists.
 [5] - program counter of the common end point. </code>
 
 Looks for and handles conditionals that are written by the Conditional
 class.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>Null if the opcode is not the start of a conditional otherwise
         the array of values.</dd>
</dl>
</li>
</ul>
<a name="splitZeroStack-org.apache.derby.impl.services.bytecode.BCMethod-org.apache.derby.iapi.services.classfile.ClassHolder-int-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>splitZeroStack</h4>
<pre>final&nbsp;int&nbsp;splitZeroStack(<a href="../../../../../../org/apache/derby/impl/services/bytecode/BCMethod.html" title="class in org.apache.derby.impl.services.bytecode">BCMethod</a>&nbsp;mb,
                         <a href="../../../../../../org/apache/derby/iapi/services/classfile/ClassHolder.html" title="class in org.apache.derby.iapi.services.classfile">ClassHolder</a>&nbsp;ch,
                         int&nbsp;split_pc,
                         int&nbsp;optimalMinLength)</pre>
<div class="block">Attempt to split the current method by pushing a chunk of
 its code into a sub-method. The starting point of the split
 (split_pc) must correspond to a stack depth of zero. It is the
 reponsibility of the caller to ensure this.
 Split is only made if there exists a chunk of code starting at
 pc=split_pc, whose stack depth upon termination is zero.
 The method will try to split a code section greater than
 optimalMinLength but may split earlier if no such block exists.
 <P>
 The method is aimed at splitting methods that contain
 many independent statements.
 <P>
 If a split is possible this method will perform the split and
 create a void sub method, and move the code into the sub-method
 and setup this method to call the sub-method before continuing.
 This method's max stack and current pc will be correctly set
 as though the method had just been created.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>mb</code> - Method for this chunk.</dd>
<dd><code>ch</code> - Class definition</dd>
<dd><code>optimalMinLength</code> - minimum length required for split</dd>
</dl>
</li>
</ul>
<a name="startSubMethod-org.apache.derby.impl.services.bytecode.BCMethod-java.lang.String-int-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>startSubMethod</h4>
<pre>private&nbsp;<a href="../../../../../../org/apache/derby/impl/services/bytecode/BCMethod.html" title="class in org.apache.derby.impl.services.bytecode">BCMethod</a>&nbsp;startSubMethod(<a href="../../../../../../org/apache/derby/impl/services/bytecode/BCMethod.html" title="class in org.apache.derby.impl.services.bytecode">BCMethod</a>&nbsp;mb,
                                java.lang.String&nbsp;returnType,
                                int&nbsp;split_pc,
                                int&nbsp;blockLength)</pre>
<div class="block">Start a sub method that we will split the portion of our current code to,
 starting from start_pc and including codeLength bytes of code.
 
 Return a BCMethod obtained from BCMethod.getNewSubMethod with the passed
 in return type and same parameters as mb if the code block to be moved
 uses parameters.</div>
</li>
</ul>
<a name="usesParameters-org.apache.derby.impl.services.bytecode.BCMethod-int-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>usesParameters</h4>
<pre>private&nbsp;boolean&nbsp;usesParameters(<a href="../../../../../../org/apache/derby/impl/services/bytecode/BCMethod.html" title="class in org.apache.derby.impl.services.bytecode">BCMethod</a>&nbsp;mb,
                               int&nbsp;pc,
                               int&nbsp;codeLength)</pre>
<div class="block">Does a section of code use parameters.
 Any load, exception ALOAD_0 in an instance method, is
 seen as using parameters, as this complete byte code
 implementation does not use local variables.</div>
</li>
</ul>
<a name="splitCodeIntoSubMethod-org.apache.derby.impl.services.bytecode.BCMethod-org.apache.derby.iapi.services.classfile.ClassHolder-org.apache.derby.impl.services.bytecode.BCMethod-int-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>splitCodeIntoSubMethod</h4>
<pre>private&nbsp;int&nbsp;splitCodeIntoSubMethod(<a href="../../../../../../org/apache/derby/impl/services/bytecode/BCMethod.html" title="class in org.apache.derby.impl.services.bytecode">BCMethod</a>&nbsp;mb,
                                   <a href="../../../../../../org/apache/derby/iapi/services/classfile/ClassHolder.html" title="class in org.apache.derby.iapi.services.classfile">ClassHolder</a>&nbsp;ch,
                                   <a href="../../../../../../org/apache/derby/impl/services/bytecode/BCMethod.html" title="class in org.apache.derby.impl.services.bytecode">BCMethod</a>&nbsp;subMethod,
                                   int&nbsp;split_pc,
                                   int&nbsp;splitLength)</pre>
<div class="block">Split a block of code from this method into a sub-method
 and call it.
 
 Returns the pc of this method just after the call
 to the sub-method.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>mb</code> - My method</dd>
<dd><code>ch</code> - My class</dd>
<dd><code>subMethod</code> - Sub-method code was pushed into</dd>
<dd><code>split_pc</code> - Program counter the split started at</dd>
<dd><code>splitLength</code> - Length of code split</dd>
</dl>
</li>
</ul>
<a name="removePushedCode-org.apache.derby.impl.services.bytecode.BCMethod-org.apache.derby.iapi.services.classfile.ClassHolder-org.apache.derby.impl.services.bytecode.BCMethod-int-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>removePushedCode</h4>
<pre>private&nbsp;int&nbsp;removePushedCode(<a href="../../../../../../org/apache/derby/impl/services/bytecode/BCMethod.html" title="class in org.apache.derby.impl.services.bytecode">BCMethod</a>&nbsp;mb,
                             <a href="../../../../../../org/apache/derby/iapi/services/classfile/ClassHolder.html" title="class in org.apache.derby.iapi.services.classfile">ClassHolder</a>&nbsp;ch,
                             <a href="../../../../../../org/apache/derby/impl/services/bytecode/BCMethod.html" title="class in org.apache.derby.impl.services.bytecode">BCMethod</a>&nbsp;subMethod,
                             int&nbsp;split_pc,
                             int&nbsp;splitLength)</pre>
<div class="block">Remove a block of code from this method that was pushed into a sub-method
 and call the sub-method.
 
 Returns the pc of this method just after the call to the sub-method.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>mb</code> - My method</dd>
<dd><code>ch</code> - My class</dd>
<dd><code>subMethod</code> - Sub-method code was pushed into</dd>
<dd><code>split_pc</code> - Program counter the split started at</dd>
<dd><code>splitLength</code> - Length of code split</dd>
</dl>
</li>
</ul>
<a name="splitExpressionOut-org.apache.derby.impl.services.bytecode.BCMethod-org.apache.derby.iapi.services.classfile.ClassHolder-int-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>splitExpressionOut</h4>
<pre>final&nbsp;int&nbsp;splitExpressionOut(<a href="../../../../../../org/apache/derby/impl/services/bytecode/BCMethod.html" title="class in org.apache.derby.impl.services.bytecode">BCMethod</a>&nbsp;mb,
                             <a href="../../../../../../org/apache/derby/iapi/services/classfile/ClassHolder.html" title="class in org.apache.derby.iapi.services.classfile">ClassHolder</a>&nbsp;ch,
                             int&nbsp;optimalMinLength,
                             int&nbsp;maxStack)</pre>
<div class="block">Split an expression out of a large method into its own
 sub-method.
 <P>
 Method call expressions are of the form:
 <UL>
 <LI> expr.method(args) -- instance method call
 <LI> method(args) -- static method call
 </UL>
 Two special cases of instance method calls will be handled
 by the first incarnation of splitExpressionOut. 
 three categories:
 <UL>
 <LI>this.method(args)
 <LI>this.getter().method(args)
 </UL>
 These calls are choosen as they are easier sub-cases
 and map to the code generated for SQL statements.
 Future coders can expand the method to cover more cases.
 <P>
 This method will split out such expressions in sub-methods
 and replace the original code with a call to that submethod.
 <UL>
 <LI>this.method(args) -&gt;&gt; this.sub1([parameters])
 <LI>this.getter().method(args) -&gt;&gt; this.sub1([parameters])
 </UL>
 The assumption is of course that the call to the sub-method
 is much smaller than the code it replaces.
 <P>
 Looking at the byte code for such calls they would look like
 (for an example three argument method):
 <code>
 this arg1 arg2 arg3 INVOKE // this.method(args)
 this INVOKE arg1 arg2 arg3 INVOKE // this.getter().metod(args)
 </code>
 The bytecode for the arguments can be arbitary long and
 consist of expressions, typical Derby code for generated
 queries is deeply nested method calls.
 <BR>
 If none of the arguments requred the parameters passed into
 the method, then in both cases the replacement bytecode
 would look like:
 <code>
 this.sub1();
 </code>
 Parameter handling is just as in the method splitZeroStack().
 <P>
 Because the VM is a stack machine the original byte code
 sequences are self contained. The stack at the start of
 is sequence is N and at the end (after the method call) will
 be:
 <UL>
 <LI> N - void method
 <LI> N + 1 - method returning a single word
 <LI> N + 2 - method returning a double word (java long or double)
 </UL>
 This code will handle the N+1 where the word is a reference,
 the typical case for generated code.
 <BR>
 The code is self contained because in general the byte code
 for the arguments will push and pop values but never drop
 below the stack value at the start of the byte code sequence.
 E.g. in the examples the stack before the first arg will be
 N+1 (the objectref for the method call) and at the end of the
 byte code for arg1 will be N+2 or N+3 depending on if arg1 is
 a single or double word argument. During the execution of
 the byte code the stack may have had many arguments pushed
 and popped, but will never have dropped below N+1. Thus the
 code for arg1 is independent of the stack's previous values
 and is self contained. This self-containment then extends to
 all the arguements, the method call itself and pushing the
 objectref for the method call, thus the complete
 sequence is self-contained.
 <BR>
 The self-containment breaks in a few cases, take the simple
 method call this.method(3), the byte code for this could be:
 <code>
 push3 this swap invoke
 </code>
 In this case the byte code for arg1 (swap) is not self-contained
 and relies on earlier stack values.
 <P>
 How to identify "self-contained blocks of code".
 <BR>
 We walk through the byte code and maintain a history of
 the program counter that indicates the start of the
 independent sequence each stack word depends on.
 Thus for a ALOAD_0 instruction which pushes 'this' the
 dependent pc is that of the this. If a DUP instruction followed
 then the top-word is now dependent on the previous word (this)
 and thus the dependence of it is equal to the dependence of
 the previous word. This information is kept in earliestIndepPC
 array as we process the instruction stream.
 <BR>
 When a INVOKE instruction is seen for an instance method
 that returns a single or double word, the dependence of
 the returned value is the dependence of the word in the
 stack that is the objectref for the call. This complete
 sequence from the pc the objectref depended on to the
 INVOKE instruction is then a self contained sequence
 and can be split into a sub-method.

 <BR>
 If the block is self-contained then it can be split, following
 similar logic to splitZeroStack().
  
  <P>
  WORK IN PROGRESS - Incremental development
  <BR>
  Currently walks the method maintaining the
  earliestIndepPC array and identifies potential blocks
  to splt, performs splits as required.
  Called by BCMethod but commented out in submitted code.
  Tested with local changes from calls in BCMethod.
  Splits generally work, though largeCodeGen shows
  a problem that will be fixed before the code in
  enabled for real.</div>
</li>
</ul>
<a name="isReturn-short-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isReturn</h4>
<pre>private static&nbsp;boolean&nbsp;isReturn(short&nbsp;opcode)</pre>
<div class="block">See if the opcode is a return instruction.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>opcode</code> - opcode to be checked</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>true for is a return instruction, false otherwise.</dd>
</dl>
</li>
</ul>
<a name="splitMinLength-org.apache.derby.impl.services.bytecode.BCMethod-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>splitMinLength</h4>
<pre>private static&nbsp;int&nbsp;splitMinLength(<a href="../../../../../../org/apache/derby/impl/services/bytecode/BCMethod.html" title="class in org.apache.derby.impl.services.bytecode">BCMethod</a>&nbsp;mb)</pre>
<div class="block">Minimum split length for a sub-method. If the number of
 instructions to call the sub-method exceeds the length
 of the sub-method, then there's no point splitting.
 The number of bytes in the code stream to call
 a generated sub-method can take is based upon the number of method args.
 A method can have maximum of 255 words of arguments (section 4.10 JVM spec)
 which in the worst case would be 254 (one-word) parameters
 and this. For a sub-method the arguments will come from the
 parameters to the method, i.e. ALOAD, ILOAD etc.
 <BR>
 This leads to this number of instructions.
 <UL>
 <LI> 4 - 'this' and first 3 parameters have single byte instructions
 <LI> (N-4)*2 - Remaining parameters have two byte instructions
 <LI> 3 for the invoke instruction.
 </UL></div>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
<div class="aboutLanguage">Built on Mon 2017-07-03 23:03:59+0530, from revision Unversioned directory</div>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../../org/apache/derby/impl/services/bytecode/BCMethodDescriptor.html" title="class in org.apache.derby.impl.services.bytecode"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../../../org/apache/derby/impl/services/bytecode/Conditional.html" title="class in org.apache.derby.impl.services.bytecode"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../../index.html?org/apache/derby/impl/services/bytecode/CodeChunk.html" target="_top">Frames</a></li>
<li><a href="CodeChunk.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>Apache Derby V10.13 Internals - <i>Copyright &copy; 2004,2016 The Apache Software Foundation. All Rights Reserved.</i></small></p>
</body>
</html>
