<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_66) on Mon Jul 03 23:05:21 IST 2017 -->
<title>JCECipherFactory (Apache Derby V10.13 Internals)</title>
<meta name="date" content="2017-07-03">
<link rel="stylesheet" type="text/css" href="../../../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="JCECipherFactory (Apache Derby V10.13 Internals)";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":10,"i1":10,"i2":10,"i3":10,"i4":10,"i5":10,"i6":10,"i7":10,"i8":10,"i9":10,"i10":10,"i11":10,"i12":10,"i13":10,"i14":10,"i15":10,"i16":10,"i17":10,"i18":9,"i19":10,"i20":10,"i21":10,"i22":10};
var tabs = {65535:["t0","All Methods"],1:["t1","Static Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev&nbsp;Class</li>
<li><a href="../../../../../../org/apache/derby/impl/services/jce/JCECipherFactory.EncryptedKeyResult.html" title="class in org.apache.derby.impl.services.jce"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../../index.html?org/apache/derby/impl/services/jce/JCECipherFactory.html" target="_top">Frames</a></li>
<li><a href="JCECipherFactory.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">org.apache.derby.impl.services.jce</div>
<h2 title="Class JCECipherFactory" class="title">Class JCECipherFactory</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>org.apache.derby.impl.services.jce.JCECipherFactory</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd><a href="../../../../../../org/apache/derby/iapi/services/crypto/CipherFactory.html" title="interface in org.apache.derby.iapi.services.crypto">CipherFactory</a></dd>
</dl>
<hr>
<br>
<pre>final class <span class="typeNameLabel">JCECipherFactory</span>
extends java.lang.Object
implements <a href="../../../../../../org/apache/derby/iapi/services/crypto/CipherFactory.html" title="interface in org.apache.derby.iapi.services.crypto">CipherFactory</a></pre>
<div class="block">This CipherFactory creates new JCECipherProvider.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../../org/apache/derby/iapi/services/crypto/CipherFactory.html" title="interface in org.apache.derby.iapi.services.crypto"><code>CipherFactory</code></a></dd>
</dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="nested.class.summary">
<!--   -->
</a>
<h3>Nested Class Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Nested Class Summary table, listing nested classes, and an explanation">
<caption><span>Nested Classes</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Class and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static class&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/jce/JCECipherFactory.EncryptedKeyResult.html" title="class in org.apache.derby.impl.services.jce">JCECipherFactory.EncryptedKeyResult</a></span></code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/jce/JCECipherFactory.html#AES">AES</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/jce/JCECipherFactory.html#AES_IV_LENGTH">AES_IV_LENGTH</a></span></code>
<div class="block">AES encryption takes in an default Initialization vector length (IV) length of 16 bytes
        This is needed to generate an IV to use for encryption and decryption process</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/jce/JCECipherFactory.html#BLOCK_LENGTH">BLOCK_LENGTH</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/jce/JCECipherFactory.html#cryptoAlgorithm">cryptoAlgorithm</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/jce/JCECipherFactory.html#cryptoAlgorithmShort">cryptoAlgorithmShort</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/jce/JCECipherFactory.html#cryptoProvider">cryptoProvider</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/jce/JCECipherFactory.html#cryptoProviderShort">cryptoProviderShort</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/jce/JCECipherFactory.html#DEFAULT_ALGORITHM">DEFAULT_ALGORITHM</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/jce/JCECipherFactory.html#DES">DES</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/jce/JCECipherFactory.html#DESede">DESede</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/jce/JCECipherFactory.html#encodedKeyLength">encodedKeyLength</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/jce/JCECipherFactory.html#keyLengthBits">keyLengthBits</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private byte[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/jce/JCECipherFactory.html#mainIV">mainIV</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private javax.crypto.SecretKey</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/jce/JCECipherFactory.html#mainSecretKey">mainSecretKey</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/jce/JCECipherFactory.html#MESSAGE_DIGEST">MESSAGE_DIGEST</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private java.security.MessageDigest</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/jce/JCECipherFactory.html#messageDigest">messageDigest</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private java.util.Properties</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/jce/JCECipherFactory.html#persistentProperties">persistentProperties</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/jce/JCECipherFactory.html#TripleDES">TripleDES</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/jce/JCECipherFactory.html#VERIFYKEY_DATALEN">VERIFYKEY_DATALEN</a></span></code>
<div class="block">Amount of data that is used for verification of external encryption key
            This does not include the MD5 checksum bytes</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="fields.inherited.from.class.org.apache.derby.iapi.services.crypto.CipherFactory">
<!--   -->
</a>
<h3>Fields inherited from interface&nbsp;org.apache.derby.iapi.services.crypto.<a href="../../../../../../org/apache/derby/iapi/services/crypto/CipherFactory.html" title="interface in org.apache.derby.iapi.services.crypto">CipherFactory</a></h3>
<code><a href="../../../../../../org/apache/derby/iapi/services/crypto/CipherFactory.html#DECRYPT">DECRYPT</a>, <a href="../../../../../../org/apache/derby/iapi/services/crypto/CipherFactory.html#ENCRYPT">ENCRYPT</a>, <a href="../../../../../../org/apache/derby/iapi/services/crypto/CipherFactory.html#MIN_BOOTPASS_LENGTH">MIN_BOOTPASS_LENGTH</a></code></li>
</ul>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/jce/JCECipherFactory.html#JCECipherFactory-boolean-java.util.Properties-boolean-">JCECipherFactory</a></span>(boolean&nbsp;create,
                java.util.Properties&nbsp;props,
                boolean&nbsp;newAttributes)</code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t1" class="tableTab"><span><a href="javascript:show(1);">Static Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/jce/JCECipherFactory.html#changeBootPassword-java.lang.String-java.util.Properties-org.apache.derby.iapi.services.crypto.CipherProvider-">changeBootPassword</a></span>(java.lang.String&nbsp;changeString,
                  java.util.Properties&nbsp;properties,
                  <a href="../../../../../../org/apache/derby/iapi/services/crypto/CipherProvider.html" title="interface in org.apache.derby.iapi.services.crypto">CipherProvider</a>&nbsp;verify)</code>&nbsp;</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code><a href="../../../../../../org/apache/derby/iapi/services/crypto/CipherProvider.html" title="interface in org.apache.derby.iapi.services.crypto">CipherProvider</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/jce/JCECipherFactory.html#createNewCipher-int-">createNewCipher</a></span>(int&nbsp;mode)</code>
<div class="block">Returns a CipherProvider which is the encryption or decryption engine.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>private <a href="../../../../../../org/apache/derby/iapi/services/crypto/CipherProvider.html" title="interface in org.apache.derby.iapi.services.crypto">CipherProvider</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/jce/JCECipherFactory.html#createNewCipher-int-javax.crypto.SecretKey-byte:A-">createNewCipher</a></span>(int&nbsp;mode,
               javax.crypto.SecretKey&nbsp;secretKey,
               byte[]&nbsp;iv)</code>&nbsp;</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>private byte[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/jce/JCECipherFactory.html#decryptKey-java.lang.String-int-byte:A-">decryptKey</a></span>(java.lang.String&nbsp;encryptedKey,
          int&nbsp;encodedKeyCharLength,
          byte[]&nbsp;bootPassword)</code>
<div class="block">Decrypt the secretKey with the user key .</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>private int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/jce/JCECipherFactory.html#digest-byte:A-">digest</a></span>(byte[]&nbsp;input)</code>&nbsp;</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>private <a href="../../../../../../org/apache/derby/impl/services/jce/JCECipherFactory.EncryptedKeyResult.html" title="class in org.apache.derby.impl.services.jce">JCECipherFactory.EncryptedKeyResult</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/jce/JCECipherFactory.html#encryptKey-byte:A-byte:A-">encryptKey</a></span>(byte[]&nbsp;secretKey,
          byte[]&nbsp;bootPassword)</code>
<div class="block">Encrypt the secretKey with the boot password.</div>
</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code>private byte[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/jce/JCECipherFactory.html#generateIV-byte:A-">generateIV</a></span>(byte[]&nbsp;secretKey)</code>
<div class="block">Generate an IV using the input secretKey that can be used by
                JCECipherProvider to encrypt or decrypt.</div>
</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code>private javax.crypto.SecretKey</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/jce/JCECipherFactory.html#generateKey-byte:A-">generateKey</a></span>(byte[]&nbsp;secretKey)</code>
<div class="block">Generate a Key object using the input secretKey that can be used by
                JCECipherProvider to encrypt or decrypt.</div>
</td>
</tr>
<tr id="i8" class="altColor">
<td class="colFirst"><code>private byte[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/jce/JCECipherFactory.html#generateUniqueBytes--">generateUniqueBytes</a></span>()</code>&nbsp;</td>
</tr>
<tr id="i9" class="rowColor">
<td class="colFirst"><code>private byte[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/jce/JCECipherFactory.html#getDatabaseSecretKey-java.util.Properties-byte:A-java.lang.String-">getDatabaseSecretKey</a></span>(java.util.Properties&nbsp;properties,
                    byte[]&nbsp;bootPassword,
                    java.lang.String&nbsp;errorState)</code>
<div class="block">get the secretkey used for encryption and decryption when boot password mechanism is used for encryption
                Steps include 
                retrieve the stored key, decrypt the stored key and verify if the correct boot password was passed 
                There is a possibility that the decrypted key includes the original key and padded bytes in order to have
                been block size aligned during encryption phase.</div>
</td>
</tr>
<tr id="i10" class="altColor">
<td class="colFirst"><code>private byte[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/jce/JCECipherFactory.html#getMD5Checksum-byte:A-">getMD5Checksum</a></span>(byte[]&nbsp;data)</code>
<div class="block">Use MD5 MessageDigest algorithm to generate checksum</div>
</td>
</tr>
<tr id="i11" class="rowColor">
<td class="colFirst"><code>private byte[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/jce/JCECipherFactory.html#getMuckFromBootPassword-byte:A-int-">getMuckFromBootPassword</a></span>(byte[]&nbsp;bootPassword,
                       int&nbsp;encodedKeyByteLength)</code>&nbsp;</td>
</tr>
<tr id="i12" class="altColor">
<td class="colFirst"><code>java.security.SecureRandom</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/jce/JCECipherFactory.html#getSecureRandom--">getSecureRandom</a></span>()</code>&nbsp;</td>
</tr>
<tr id="i13" class="rowColor">
<td class="colFirst"><code>private byte[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/jce/JCECipherFactory.html#handleBootPassword-boolean-java.util.Properties-boolean-">handleBootPassword</a></span>(boolean&nbsp;create,
                  java.util.Properties&nbsp;properties,
                  boolean&nbsp;newPasswd)</code>&nbsp;</td>
</tr>
<tr id="i14" class="altColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/jce/JCECipherFactory.html#init-boolean-java.util.Properties-boolean-">init</a></span>(boolean&nbsp;create,
    java.util.Properties&nbsp;properties,
    boolean&nbsp;newAttrs)</code>&nbsp;</td>
</tr>
<tr id="i15" class="rowColor">
<td class="colFirst"><code>private byte[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/jce/JCECipherFactory.html#padKey-byte:A-int-">padKey</a></span>(byte[]&nbsp;secretKey,
      int&nbsp;blockSizeAlign)</code>
<div class="block">For block ciphers, and  algorithms using the NoPadding scheme, the data that has 
            to be encrypted needs to be a multiple of the expected block size for the cipher 
            Pad the key with appropriate padding to make it blockSize align</div>
</td>
</tr>
<tr id="i16" class="altColor">
<td class="colFirst"><code>private <a href="../../../../../../org/apache/derby/io/StorageRandomAccessFile.html" title="interface in org.apache.derby.io">StorageRandomAccessFile</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/jce/JCECipherFactory.html#privAccessFile-org.apache.derby.io.StorageFactory-java.lang.String-java.lang.String-">privAccessFile</a></span>(<a href="../../../../../../org/apache/derby/io/StorageFactory.html" title="interface in org.apache.derby.io">StorageFactory</a>&nbsp;storageFactory,
              java.lang.String&nbsp;fileName,
              java.lang.String&nbsp;filePerms)</code>
<div class="block">access a file for either read/write</div>
</td>
</tr>
<tr id="i17" class="rowColor">
<td class="colFirst"><code>private java.io.InputStream</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/jce/JCECipherFactory.html#privAccessGetInputStream-org.apache.derby.io.StorageFactory-java.lang.String-">privAccessGetInputStream</a></span>(<a href="../../../../../../org/apache/derby/io/StorageFactory.html" title="interface in org.apache.derby.io">StorageFactory</a>&nbsp;storageFactory,
                        java.lang.String&nbsp;fileName)</code>
<div class="block">access a InputStream for a given file for reading.</div>
</td>
</tr>
<tr id="i18" class="altColor">
<td class="colFirst"><code>(package private) static java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/jce/JCECipherFactory.html#providerErrorName-java.lang.String-">providerErrorName</a></span>(java.lang.String&nbsp;cps)</code>&nbsp;</td>
</tr>
<tr id="i19" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/jce/JCECipherFactory.html#saveProperties-java.util.Properties-">saveProperties</a></span>(java.util.Properties&nbsp;properties)</code>&nbsp;</td>
</tr>
<tr id="i20" class="altColor">
<td class="colFirst"><code>private java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/jce/JCECipherFactory.html#saveSecretKey-byte:A-byte:A-">saveSecretKey</a></span>(byte[]&nbsp;secretKey,
             byte[]&nbsp;bootPassword)</code>&nbsp;</td>
</tr>
<tr id="i21" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/jce/JCECipherFactory.html#verifyKey-boolean-org.apache.derby.io.StorageFactory-java.util.Properties-">verifyKey</a></span>(boolean&nbsp;create,
         <a href="../../../../../../org/apache/derby/io/StorageFactory.html" title="interface in org.apache.derby.io">StorageFactory</a>&nbsp;sf,
         java.util.Properties&nbsp;properties)</code>
<div class="block">The database can be encrypted with an encryption key given in connection url.</div>
</td>
</tr>
<tr id="i22" class="altColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/derby/impl/services/jce/JCECipherFactory.html#vetCipherProviders-org.apache.derby.iapi.services.crypto.CipherProvider-org.apache.derby.iapi.services.crypto.CipherProvider-java.lang.String-">vetCipherProviders</a></span>(<a href="../../../../../../org/apache/derby/iapi/services/crypto/CipherProvider.html" title="interface in org.apache.derby.iapi.services.crypto">CipherProvider</a>&nbsp;decrypter,
                  <a href="../../../../../../org/apache/derby/iapi/services/crypto/CipherProvider.html" title="interface in org.apache.derby.iapi.services.crypto">CipherProvider</a>&nbsp;encrypter,
                  java.lang.String&nbsp;sqlState)</code>
<div class="block">
 Verify that a decrypter matches an encrypter.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="MESSAGE_DIGEST">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>MESSAGE_DIGEST</h4>
<pre>private static final&nbsp;java.lang.String MESSAGE_DIGEST</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../../constant-values.html#org.apache.derby.impl.services.jce.JCECipherFactory.MESSAGE_DIGEST">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="DEFAULT_ALGORITHM">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>DEFAULT_ALGORITHM</h4>
<pre>private static final&nbsp;java.lang.String DEFAULT_ALGORITHM</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../../constant-values.html#org.apache.derby.impl.services.jce.JCECipherFactory.DEFAULT_ALGORITHM">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="DES">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>DES</h4>
<pre>private static final&nbsp;java.lang.String DES</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../../constant-values.html#org.apache.derby.impl.services.jce.JCECipherFactory.DES">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="DESede">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>DESede</h4>
<pre>private static final&nbsp;java.lang.String DESede</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../../constant-values.html#org.apache.derby.impl.services.jce.JCECipherFactory.DESede">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="TripleDES">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>TripleDES</h4>
<pre>private static final&nbsp;java.lang.String TripleDES</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../../constant-values.html#org.apache.derby.impl.services.jce.JCECipherFactory.TripleDES">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="AES">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>AES</h4>
<pre>private static final&nbsp;java.lang.String AES</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../../constant-values.html#org.apache.derby.impl.services.jce.JCECipherFactory.AES">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="BLOCK_LENGTH">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>BLOCK_LENGTH</h4>
<pre>private static final&nbsp;int BLOCK_LENGTH</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../../constant-values.html#org.apache.derby.impl.services.jce.JCECipherFactory.BLOCK_LENGTH">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="AES_IV_LENGTH">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>AES_IV_LENGTH</h4>
<pre>private static final&nbsp;int AES_IV_LENGTH</pre>
<div class="block">AES encryption takes in an default Initialization vector length (IV) length of 16 bytes
        This is needed to generate an IV to use for encryption and decryption process</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../../org/apache/derby/iapi/services/crypto/CipherProvider.html" title="interface in org.apache.derby.iapi.services.crypto"><code>CipherProvider</code></a>, 
<a href="../../../../../../constant-values.html#org.apache.derby.impl.services.jce.JCECipherFactory.AES_IV_LENGTH">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="keyLengthBits">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>keyLengthBits</h4>
<pre>private&nbsp;int keyLengthBits</pre>
</li>
</ul>
<a name="encodedKeyLength">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>encodedKeyLength</h4>
<pre>private&nbsp;int encodedKeyLength</pre>
</li>
</ul>
<a name="cryptoAlgorithm">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>cryptoAlgorithm</h4>
<pre>private&nbsp;java.lang.String cryptoAlgorithm</pre>
</li>
</ul>
<a name="cryptoAlgorithmShort">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>cryptoAlgorithmShort</h4>
<pre>private&nbsp;java.lang.String cryptoAlgorithmShort</pre>
</li>
</ul>
<a name="cryptoProvider">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>cryptoProvider</h4>
<pre>private&nbsp;java.lang.String cryptoProvider</pre>
</li>
</ul>
<a name="cryptoProviderShort">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>cryptoProviderShort</h4>
<pre>private&nbsp;java.lang.String cryptoProviderShort</pre>
</li>
</ul>
<a name="messageDigest">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>messageDigest</h4>
<pre>private&nbsp;java.security.MessageDigest messageDigest</pre>
</li>
</ul>
<a name="mainSecretKey">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>mainSecretKey</h4>
<pre>private&nbsp;javax.crypto.SecretKey mainSecretKey</pre>
</li>
</ul>
<a name="mainIV">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>mainIV</h4>
<pre>private&nbsp;byte[] mainIV</pre>
</li>
</ul>
<a name="persistentProperties">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>persistentProperties</h4>
<pre>private&nbsp;java.util.Properties persistentProperties</pre>
</li>
</ul>
<a name="VERIFYKEY_DATALEN">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>VERIFYKEY_DATALEN</h4>
<pre>private static final&nbsp;int VERIFYKEY_DATALEN</pre>
<div class="block">Amount of data that is used for verification of external encryption key
            This does not include the MD5 checksum bytes</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../../constant-values.html#org.apache.derby.impl.services.jce.JCECipherFactory.VERIFYKEY_DATALEN">Constant Field Values</a></dd>
</dl>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="JCECipherFactory-boolean-java.util.Properties-boolean-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>JCECipherFactory</h4>
<pre>JCECipherFactory(boolean&nbsp;create,
                 java.util.Properties&nbsp;props,
                 boolean&nbsp;newAttributes)
          throws <a href="../../../../../../org/apache/derby/iapi/error/StandardException.html" title="class in org.apache.derby.iapi.error">StandardException</a></pre>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../../org/apache/derby/iapi/error/StandardException.html" title="class in org.apache.derby.iapi.error">StandardException</a></code></dd>
</dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="providerErrorName-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>providerErrorName</h4>
<pre>static&nbsp;java.lang.String&nbsp;providerErrorName(java.lang.String&nbsp;cps)</pre>
</li>
</ul>
<a name="generateUniqueBytes--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>generateUniqueBytes</h4>
<pre>private&nbsp;byte[]&nbsp;generateUniqueBytes()
                            throws <a href="../../../../../../org/apache/derby/iapi/error/StandardException.html" title="class in org.apache.derby.iapi.error">StandardException</a></pre>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../../org/apache/derby/iapi/error/StandardException.html" title="class in org.apache.derby.iapi.error">StandardException</a></code></dd>
</dl>
</li>
</ul>
<a name="encryptKey-byte:A-byte:A-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>encryptKey</h4>
<pre>private&nbsp;<a href="../../../../../../org/apache/derby/impl/services/jce/JCECipherFactory.EncryptedKeyResult.html" title="class in org.apache.derby.impl.services.jce">JCECipherFactory.EncryptedKeyResult</a>&nbsp;encryptKey(byte[]&nbsp;secretKey,
                                                       byte[]&nbsp;bootPassword)
                                                throws <a href="../../../../../../org/apache/derby/iapi/error/StandardException.html" title="class in org.apache.derby.iapi.error">StandardException</a></pre>
<div class="block">Encrypt the secretKey with the boot password.
                This includes the following steps, 
                getting muck from the boot password and then using this to generate a key,
                generating an appropriate IV using the muck
                using the key and IV thus generated to create the appropriate cipher provider
                and encrypting the secretKey</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>hexadecimal string of the encrypted secretKey</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../../org/apache/derby/iapi/error/StandardException.html" title="class in org.apache.derby.iapi.error">StandardException</a></code> - Standard Derby error policy</dd>
</dl>
</li>
</ul>
<a name="padKey-byte:A-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>padKey</h4>
<pre>private&nbsp;byte[]&nbsp;padKey(byte[]&nbsp;secretKey,
                      int&nbsp;blockSizeAlign)</pre>
<div class="block">For block ciphers, and  algorithms using the NoPadding scheme, the data that has 
            to be encrypted needs to be a multiple of the expected block size for the cipher 
            Pad the key with appropriate padding to make it blockSize align</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>secretKey</code> - the data that needs blocksize alignment</dd>
<dd><code>blockSizeAlign</code> - secretKey needs to be blocksize aligned</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>a byte array with the contents of secretKey along with padded bytes in the end
                       to make it blockSize aligned</dd>
</dl>
</li>
</ul>
<a name="decryptKey-java.lang.String-int-byte:A-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>decryptKey</h4>
<pre>private&nbsp;byte[]&nbsp;decryptKey(java.lang.String&nbsp;encryptedKey,
                          int&nbsp;encodedKeyCharLength,
                          byte[]&nbsp;bootPassword)
                   throws <a href="../../../../../../org/apache/derby/iapi/error/StandardException.html" title="class in org.apache.derby.iapi.error">StandardException</a></pre>
<div class="block">Decrypt the secretKey with the user key .
            This includes the following steps, 
            retrieve the encryptedKey, generate the muck from the boot password and generate an appropriate IV using
            the muck,and using the key and IV decrypt the encryptedKey</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>decrypted key</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../../org/apache/derby/iapi/error/StandardException.html" title="class in org.apache.derby.iapi.error">StandardException</a></code> - Standard Derby error policy</dd>
</dl>
</li>
</ul>
<a name="getMuckFromBootPassword-byte:A-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getMuckFromBootPassword</h4>
<pre>private&nbsp;byte[]&nbsp;getMuckFromBootPassword(byte[]&nbsp;bootPassword,
                                       int&nbsp;encodedKeyByteLength)</pre>
</li>
</ul>
<a name="generateKey-byte:A-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>generateKey</h4>
<pre>private&nbsp;javax.crypto.SecretKey&nbsp;generateKey(byte[]&nbsp;secretKey)
                                    throws <a href="../../../../../../org/apache/derby/iapi/error/StandardException.html" title="class in org.apache.derby.iapi.error">StandardException</a></pre>
<div class="block">Generate a Key object using the input secretKey that can be used by
                JCECipherProvider to encrypt or decrypt.</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../../org/apache/derby/iapi/error/StandardException.html" title="class in org.apache.derby.iapi.error">StandardException</a></code> - Standard Derby Error Policy</dd>
</dl>
</li>
</ul>
<a name="generateIV-byte:A-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>generateIV</h4>
<pre>private&nbsp;byte[]&nbsp;generateIV(byte[]&nbsp;secretKey)</pre>
<div class="block">Generate an IV using the input secretKey that can be used by
                JCECipherProvider to encrypt or decrypt.</div>
</li>
</ul>
<a name="digest-byte:A-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>digest</h4>
<pre>private&nbsp;int&nbsp;digest(byte[]&nbsp;input)</pre>
</li>
</ul>
<a name="getSecureRandom--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getSecureRandom</h4>
<pre>public&nbsp;java.security.SecureRandom&nbsp;getSecureRandom()</pre>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../../../../../org/apache/derby/iapi/services/crypto/CipherFactory.html#getSecureRandom--">getSecureRandom</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../../../org/apache/derby/iapi/services/crypto/CipherFactory.html" title="interface in org.apache.derby.iapi.services.crypto">CipherFactory</a></code></dd>
</dl>
</li>
</ul>
<a name="createNewCipher-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>createNewCipher</h4>
<pre>public&nbsp;<a href="../../../../../../org/apache/derby/iapi/services/crypto/CipherProvider.html" title="interface in org.apache.derby.iapi.services.crypto">CipherProvider</a>&nbsp;createNewCipher(int&nbsp;mode)
                               throws <a href="../../../../../../org/apache/derby/iapi/error/StandardException.html" title="class in org.apache.derby.iapi.error">StandardException</a></pre>
<div class="block"><span class="descfrmTypeLabel">Description copied from interface:&nbsp;<code><a href="../../../../../../org/apache/derby/iapi/services/crypto/CipherFactory.html#createNewCipher-int-">CipherFactory</a></code></span></div>
<div class="block">Returns a CipherProvider which is the encryption or decryption engine.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../../../../../org/apache/derby/iapi/services/crypto/CipherFactory.html#createNewCipher-int-">createNewCipher</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../../../org/apache/derby/iapi/services/crypto/CipherFactory.html" title="interface in org.apache.derby.iapi.services.crypto">CipherFactory</a></code></dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>mode</code> - is either ENCRYPT or DECRYPT.  The CipherProvider can only
                                do encryption or decryption but not both.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../../org/apache/derby/iapi/error/StandardException.html" title="class in org.apache.derby.iapi.error">StandardException</a></code> - Standard Derby Error Policy</dd>
</dl>
</li>
</ul>
<a name="createNewCipher-int-javax.crypto.SecretKey-byte:A-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>createNewCipher</h4>
<pre>private&nbsp;<a href="../../../../../../org/apache/derby/iapi/services/crypto/CipherProvider.html" title="interface in org.apache.derby.iapi.services.crypto">CipherProvider</a>&nbsp;createNewCipher(int&nbsp;mode,
                                       javax.crypto.SecretKey&nbsp;secretKey,
                                       byte[]&nbsp;iv)
                                throws <a href="../../../../../../org/apache/derby/iapi/error/StandardException.html" title="class in org.apache.derby.iapi.error">StandardException</a></pre>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../../org/apache/derby/iapi/error/StandardException.html" title="class in org.apache.derby.iapi.error">StandardException</a></code></dd>
</dl>
</li>
</ul>
<a name="init-boolean-java.util.Properties-boolean-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>init</h4>
<pre>private&nbsp;void&nbsp;init(boolean&nbsp;create,
                  java.util.Properties&nbsp;properties,
                  boolean&nbsp;newAttrs)
           throws <a href="../../../../../../org/apache/derby/iapi/error/StandardException.html" title="class in org.apache.derby.iapi.error">StandardException</a></pre>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../../org/apache/derby/iapi/error/StandardException.html" title="class in org.apache.derby.iapi.error">StandardException</a></code></dd>
</dl>
</li>
</ul>
<a name="handleBootPassword-boolean-java.util.Properties-boolean-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>handleBootPassword</h4>
<pre>private&nbsp;byte[]&nbsp;handleBootPassword(boolean&nbsp;create,
                                  java.util.Properties&nbsp;properties,
                                  boolean&nbsp;newPasswd)
                           throws <a href="../../../../../../org/apache/derby/iapi/error/StandardException.html" title="class in org.apache.derby.iapi.error">StandardException</a></pre>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../../org/apache/derby/iapi/error/StandardException.html" title="class in org.apache.derby.iapi.error">StandardException</a></code></dd>
</dl>
</li>
</ul>
<a name="saveProperties-java.util.Properties-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>saveProperties</h4>
<pre>public&nbsp;void&nbsp;saveProperties(java.util.Properties&nbsp;properties)</pre>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../../../../../org/apache/derby/iapi/services/crypto/CipherFactory.html#saveProperties-java.util.Properties-">saveProperties</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../../../org/apache/derby/iapi/services/crypto/CipherFactory.html" title="interface in org.apache.derby.iapi.services.crypto">CipherFactory</a></code></dd>
</dl>
</li>
</ul>
<a name="getDatabaseSecretKey-java.util.Properties-byte:A-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getDatabaseSecretKey</h4>
<pre>private&nbsp;byte[]&nbsp;getDatabaseSecretKey(java.util.Properties&nbsp;properties,
                                    byte[]&nbsp;bootPassword,
                                    java.lang.String&nbsp;errorState)
                             throws <a href="../../../../../../org/apache/derby/iapi/error/StandardException.html" title="class in org.apache.derby.iapi.error">StandardException</a></pre>
<div class="block">get the secretkey used for encryption and decryption when boot password mechanism is used for encryption
                Steps include 
                retrieve the stored key, decrypt the stored key and verify if the correct boot password was passed 
                There is a possibility that the decrypted key includes the original key and padded bytes in order to have
                been block size aligned during encryption phase. Hence extract the original key</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>properties</code> - properties to retrieve the encrypted key</dd>
<dd><code>bootPassword</code> - boot password used to connect to the encrypted database</dd>
<dd><code>errorState</code> - errorstate to account for any errors during retrieval /creation of the secretKey</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the original unencrypted key bytes to use for encryption and decrytion</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../../org/apache/derby/iapi/error/StandardException.html" title="class in org.apache.derby.iapi.error">StandardException</a></code></dd>
</dl>
</li>
</ul>
<a name="saveSecretKey-byte:A-byte:A-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>saveSecretKey</h4>
<pre>private&nbsp;java.lang.String&nbsp;saveSecretKey(byte[]&nbsp;secretKey,
                                       byte[]&nbsp;bootPassword)
                                throws <a href="../../../../../../org/apache/derby/iapi/error/StandardException.html" title="class in org.apache.derby.iapi.error">StandardException</a></pre>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../../org/apache/derby/iapi/error/StandardException.html" title="class in org.apache.derby.iapi.error">StandardException</a></code></dd>
</dl>
</li>
</ul>
<a name="changeBootPassword-java.lang.String-java.util.Properties-org.apache.derby.iapi.services.crypto.CipherProvider-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>changeBootPassword</h4>
<pre>public&nbsp;java.lang.String&nbsp;changeBootPassword(java.lang.String&nbsp;changeString,
                                           java.util.Properties&nbsp;properties,
                                           <a href="../../../../../../org/apache/derby/iapi/services/crypto/CipherProvider.html" title="interface in org.apache.derby.iapi.services.crypto">CipherProvider</a>&nbsp;verify)
                                    throws <a href="../../../../../../org/apache/derby/iapi/error/StandardException.html" title="class in org.apache.derby.iapi.error">StandardException</a></pre>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../../../../../org/apache/derby/iapi/services/crypto/CipherFactory.html#changeBootPassword-java.lang.String-java.util.Properties-org.apache.derby.iapi.services.crypto.CipherProvider-">changeBootPassword</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../../../org/apache/derby/iapi/services/crypto/CipherFactory.html" title="interface in org.apache.derby.iapi.services.crypto">CipherFactory</a></code></dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../../org/apache/derby/iapi/error/StandardException.html" title="class in org.apache.derby.iapi.error">StandardException</a></code></dd>
</dl>
</li>
</ul>
<a name="vetCipherProviders-org.apache.derby.iapi.services.crypto.CipherProvider-org.apache.derby.iapi.services.crypto.CipherProvider-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>vetCipherProviders</h4>
<pre>private&nbsp;void&nbsp;vetCipherProviders(<a href="../../../../../../org/apache/derby/iapi/services/crypto/CipherProvider.html" title="interface in org.apache.derby.iapi.services.crypto">CipherProvider</a>&nbsp;decrypter,
                                <a href="../../../../../../org/apache/derby/iapi/services/crypto/CipherProvider.html" title="interface in org.apache.derby.iapi.services.crypto">CipherProvider</a>&nbsp;encrypter,
                                java.lang.String&nbsp;sqlState)
                         throws <a href="../../../../../../org/apache/derby/iapi/error/StandardException.html" title="class in org.apache.derby.iapi.error">StandardException</a></pre>
<div class="block"><p>
 Verify that a decrypter matches an encrypter. Raises an exception if they don't.
 The verification is performed by encrypting a block of text and checking that
 it decrypts to the same block.
 </p></div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../../org/apache/derby/iapi/error/StandardException.html" title="class in org.apache.derby.iapi.error">StandardException</a></code></dd>
</dl>
</li>
</ul>
<a name="verifyKey-boolean-org.apache.derby.io.StorageFactory-java.util.Properties-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>verifyKey</h4>
<pre>public&nbsp;void&nbsp;verifyKey(boolean&nbsp;create,
                      <a href="../../../../../../org/apache/derby/io/StorageFactory.html" title="interface in org.apache.derby.io">StorageFactory</a>&nbsp;sf,
                      java.util.Properties&nbsp;properties)
               throws <a href="../../../../../../org/apache/derby/iapi/error/StandardException.html" title="class in org.apache.derby.iapi.error">StandardException</a></pre>
<div class="block">The database can be encrypted with an encryption key given in connection url.
            For security reasons, this key is not made persistent in the database.

            But it is necessary to verify the encryption key when booting the database if it is similar
            to the one used when creating the database
            This needs to happen before we access the data/logs to avoid the risk of corrupting the 
            database because of a wrong encryption key.

            This method performs the steps necessary to verify the encryption key if an external
            encryption key is given.

            At database creation, 4k of random data is generated using SecureRandom and MD5 is used
            to compute the checksum for the random data thus generated.  This 4k page of random data
            is then encrypted using the encryption key. The checksum of unencrypted data and
            encrypted data is made persistent in the database in file by name given by
            Attribute.CRYPTO_EXTERNAL_KEY_VERIFYFILE (verifyKey.dat). This file exists directly under the
            database root directory.

            When trying to boot an existing encrypted database, the given encryption key is used to decrypt
            the data in the verifyKey.dat and the checksum is calculated and compared against the original
            stored checksum. If these checksums dont match an exception is thrown.

            Please note, this process of verifying the key  does not provide any added security but only is 
            intended to allow to fail gracefully if a wrong encryption key is used

            StandardException is thrown if there are any problems during the process of verification
                        of the encryption key or if there is any mismatch of the encryption key.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../../../../../org/apache/derby/iapi/services/crypto/CipherFactory.html#verifyKey-boolean-org.apache.derby.io.StorageFactory-java.util.Properties-">verifyKey</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../../../org/apache/derby/iapi/services/crypto/CipherFactory.html" title="interface in org.apache.derby.iapi.services.crypto">CipherFactory</a></code></dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>create</code> - true means database is being created, whereas false
                                        implies that the database has already been created</dd>
<dd><code>sf</code> - storageFactory is used to access any stored data
                                        that might be needed for verification process of the encryption key</dd>
<dd><code>properties</code> - properties at time of database connection as well as those in service.properties</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../../org/apache/derby/iapi/error/StandardException.html" title="class in org.apache.derby.iapi.error">StandardException</a></code></dd>
</dl>
</li>
</ul>
<a name="getMD5Checksum-byte:A-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getMD5Checksum</h4>
<pre>private&nbsp;byte[]&nbsp;getMD5Checksum(byte[]&nbsp;data)
                       throws <a href="../../../../../../org/apache/derby/iapi/error/StandardException.html" title="class in org.apache.derby.iapi.error">StandardException</a></pre>
<div class="block">Use MD5 MessageDigest algorithm to generate checksum</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>data</code> - data to be used to compute the hash value</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>returns the hash value computed using the data</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../../org/apache/derby/iapi/error/StandardException.html" title="class in org.apache.derby.iapi.error">StandardException</a></code></dd>
</dl>
</li>
</ul>
<a name="privAccessFile-org.apache.derby.io.StorageFactory-java.lang.String-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>privAccessFile</h4>
<pre>private&nbsp;<a href="../../../../../../org/apache/derby/io/StorageRandomAccessFile.html" title="interface in org.apache.derby.io">StorageRandomAccessFile</a>&nbsp;privAccessFile(<a href="../../../../../../org/apache/derby/io/StorageFactory.html" title="interface in org.apache.derby.io">StorageFactory</a>&nbsp;storageFactory,
                                               java.lang.String&nbsp;fileName,
                                               java.lang.String&nbsp;filePerms)
                                        throws java.io.IOException</pre>
<div class="block">access a file for either read/write</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>storageFactory</code> - factory used for io access</dd>
<dd><code>fileName</code> - name of the file to create and open for write
                                                        The file will be created directly under the database root directory</dd>
<dd><code>filePerms</code> - file permissions, if "rw" open file with read and write permissions
                                                            if "r" , open file with read permissions</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>StorageRandomAccessFile returns file with fileName for writing</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code> - Any exception during accessing the file for read/write</dd>
</dl>
</li>
</ul>
<a name="privAccessGetInputStream-org.apache.derby.io.StorageFactory-java.lang.String-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>privAccessGetInputStream</h4>
<pre>private&nbsp;java.io.InputStream&nbsp;privAccessGetInputStream(<a href="../../../../../../org/apache/derby/io/StorageFactory.html" title="interface in org.apache.derby.io">StorageFactory</a>&nbsp;storageFactory,
                                                     java.lang.String&nbsp;fileName)
                                              throws <a href="../../../../../../org/apache/derby/iapi/error/StandardException.html" title="class in org.apache.derby.iapi.error">StandardException</a></pre>
<div class="block">access a InputStream for a given file for reading.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>storageFactory</code> - factory used for io access</dd>
<dd><code>fileName</code> - name of the file to open as a stream for reading</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>InputStream returns the stream for the file with fileName for reading</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code> - Any exception during accessing the file for read</dd>
<dd><code><a href="../../../../../../org/apache/derby/iapi/error/StandardException.html" title="class in org.apache.derby.iapi.error">StandardException</a></code></dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
<div class="aboutLanguage">Built on Mon 2017-07-03 23:03:59+0530, from revision Unversioned directory</div>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev&nbsp;Class</li>
<li><a href="../../../../../../org/apache/derby/impl/services/jce/JCECipherFactory.EncryptedKeyResult.html" title="class in org.apache.derby.impl.services.jce"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../../index.html?org/apache/derby/impl/services/jce/JCECipherFactory.html" target="_top">Frames</a></li>
<li><a href="JCECipherFactory.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>Apache Derby V10.13 Internals - <i>Copyright &copy; 2004,2016 The Apache Software Foundation. All Rights Reserved.</i></small></p>
</body>
</html>
