<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_66) on Mon Jul 03 23:05:04 IST 2017 -->
<title>LOBStateTracker (Apache Derby V10.13 Internals)</title>
<meta name="date" content="2017-07-03">
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="LOBStateTracker (Apache Derby V10.13 Internals)";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":10,"i1":10,"i2":10};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../org/apache/derby/client/am/Lob.html" title="class in org.apache.derby.client.am"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../../org/apache/derby/client/am/LogicalCallableStatement.html" title="class in org.apache.derby.client.am"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?org/apache/derby/client/am/LOBStateTracker.html" target="_top">Frames</a></li>
<li><a href="LOBStateTracker.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">org.apache.derby.client.am</div>
<h2 title="Class LOBStateTracker" class="title">Class LOBStateTracker</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>org.apache.derby.client.am.LOBStateTracker</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>class <span class="typeNameLabel">LOBStateTracker</span>
extends java.lang.Object</pre>
<div class="block">An object that tracks the state of large objects (LOBs) for the current row
 in a result set.
 <p>
 A LOB's state is either unpublished or published. When a LOB is published, it
 means that the end-user has been given a reference to the LOB object. This
 implies that the LOB cannot be automatically freed/released when the
 result set position changes (i.e. typically <code>rs.next()</code>), because the
 LOB object must be kept valid/alive until the transaction is ended or the
 LOB object is explicitly freed.
 <p>
 This class covers two types of functionality regarding LOBs;
 <ul>
      <li>Keep track of whether a LOB column has been published or not.</li>
      <li>Release LOB locators on the server.</li>
 </ul>
 Both functionalities will be disabled if the server doesn't support locators.
 If locators are enabled, they will be freed when <a href="../../../../../org/apache/derby/client/am/LOBStateTracker.html#checkCurrentRow-org.apache.derby.client.am.Cursor-"><code>checkCurrentRow(org.apache.derby.client.am.Cursor)</code></a> is
 called.
 <p>
 The tracker has a notion of current row. The current row is changed by
 calling <a href="../../../../../org/apache/derby/client/am/LOBStateTracker.html#checkCurrentRow-org.apache.derby.client.am.Cursor-"><code>checkCurrentRow</code></a>. The owner of the tracker
 is repsonsible for invoking the method at the correct time, and only when
 the cursor is positioned on a valid data row. The method must be invoked
 before the cursor changes the position. Note that calling the method
 <a href="../../../../../org/apache/derby/client/am/LOBStateTracker.html#discardState--"><code>discardState</code></a> makes <code>checkCurrentRow</code> ignore all
 LOBs on the subsequent call.</div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private int[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/derby/client/am/LOBStateTracker.html#columns">columns</a></span></code>
<div class="block">1-based column indexes for the LOBs to track.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/derby/client/am/LOBStateTracker.html#doRelease">doRelease</a></span></code>
<div class="block">Tells whether locators shall be released.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private boolean[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/derby/client/am/LOBStateTracker.html#isBlob">isBlob</a></span></code>
<div class="block">Tells whether the LOB is Blob or a Clob.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private int[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/derby/client/am/LOBStateTracker.html#lastLocatorSeen">lastLocatorSeen</a></span></code>
<div class="block">The last locator values seen when releasing.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static <a href="../../../../../org/apache/derby/client/am/LOBStateTracker.html" title="class in org.apache.derby.client.am">LOBStateTracker</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/derby/client/am/LOBStateTracker.html#NO_OP_TRACKER">NO_OP_TRACKER</a></span></code>
<div class="block">Instance to use when there are no LOBs in the result set, or when the
 server doesn't support locators.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private boolean[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/derby/client/am/LOBStateTracker.html#published">published</a></span></code>
<div class="block">Tells whether the LOB colum has been published for the current row.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../../org/apache/derby/client/am/LOBStateTracker.html#LOBStateTracker-int:A-boolean:A-boolean-">LOBStateTracker</a></span>(int[]&nbsp;lobIndexes,
               boolean[]&nbsp;isBlob,
               boolean&nbsp;doRelease)</code>
<div class="block">Creates a LOB state tracker for the specified configuration.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>(package private) void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/derby/client/am/LOBStateTracker.html#checkCurrentRow-org.apache.derby.client.am.Cursor-">checkCurrentRow</a></span>(<a href="../../../../../org/apache/derby/client/am/Cursor.html" title="class in org.apache.derby.client.am">Cursor</a>&nbsp;cursor)</code>
<div class="block">Checks the current row, updating state and releasing locators on the
 server as required.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>(package private) void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/derby/client/am/LOBStateTracker.html#discardState--">discardState</a></span>()</code>
<div class="block">Discards all recorded dynamic state about LOBs.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>(package private) void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../org/apache/derby/client/am/LOBStateTracker.html#markAsPublished-int-">markAsPublished</a></span>(int&nbsp;index)</code>
<div class="block">Marks the specified column of the current row as published, which implies
 that the tracker should not release the associated locator.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="NO_OP_TRACKER">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>NO_OP_TRACKER</h4>
<pre>public static final&nbsp;<a href="../../../../../org/apache/derby/client/am/LOBStateTracker.html" title="class in org.apache.derby.client.am">LOBStateTracker</a> NO_OP_TRACKER</pre>
<div class="block">Instance to use when there are no LOBs in the result set, or when the
 server doesn't support locators.</div>
</li>
</ul>
<a name="columns">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>columns</h4>
<pre>private final&nbsp;int[] columns</pre>
<div class="block">1-based column indexes for the LOBs to track.</div>
</li>
</ul>
<a name="isBlob">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isBlob</h4>
<pre>private final&nbsp;boolean[] isBlob</pre>
<div class="block">Tells whether the LOB is Blob or a Clob.</div>
</li>
</ul>
<a name="published">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>published</h4>
<pre>private final&nbsp;boolean[] published</pre>
<div class="block">Tells whether the LOB colum has been published for the current row.</div>
</li>
</ul>
<a name="doRelease">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>doRelease</h4>
<pre>private final&nbsp;boolean doRelease</pre>
<div class="block">Tells whether locators shall be released. This will be <code>false</code> if
 locators are not supported by the server.</div>
</li>
</ul>
<a name="lastLocatorSeen">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>lastLocatorSeen</h4>
<pre>private final&nbsp;int[] lastLocatorSeen</pre>
<div class="block">The last locator values seen when releasing. These values are used to
 detect if <a href="../../../../../org/apache/derby/client/am/LOBStateTracker.html#checkCurrentRow-org.apache.derby.client.am.Cursor-">checkCurrentRow(org.apache.derby.client.am.Cursor)</a> is being executed more than once
 on the same row.</div>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="LOBStateTracker-int:A-boolean:A-boolean-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>LOBStateTracker</h4>
<pre>LOBStateTracker(int[]&nbsp;lobIndexes,
                boolean[]&nbsp;isBlob,
                boolean&nbsp;doRelease)</pre>
<div class="block">Creates a LOB state tracker for the specified configuration.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>lobIndexes</code> - the 1-based indexes of the LOB columns</dd>
<dd><code>isBlob</code> - whether the LOB is a Blob or a Clob</dd>
<dd><code>doRelease</code> - whether locators shall be released</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../org/apache/derby/client/am/LOBStateTracker.html#NO_OP_TRACKER"><code>NO_OP_TRACKER</code></a></dd>
</dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="checkCurrentRow-org.apache.derby.client.am.Cursor-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>checkCurrentRow</h4>
<pre>void&nbsp;checkCurrentRow(<a href="../../../../../org/apache/derby/client/am/Cursor.html" title="class in org.apache.derby.client.am">Cursor</a>&nbsp;cursor)
              throws <a href="../../../../../org/apache/derby/client/am/SqlException.html" title="class in org.apache.derby.client.am">SqlException</a></pre>
<div class="block">Checks the current row, updating state and releasing locators on the
 server as required.
 <p>
 This method should only be called once per valid row in the result set.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>cursor</code> - the cursor object to use for releasing the locators</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../org/apache/derby/client/am/SqlException.html" title="class in org.apache.derby.client.am">SqlException</a></code> - if releasing the locators on the server fails</dd>
</dl>
</li>
</ul>
<a name="discardState--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>discardState</h4>
<pre>void&nbsp;discardState()</pre>
<div class="block">Discards all recorded dynamic state about LOBs.
 <p>
 Typically called after connection commit or rollback, as those operations
 will release all locators on the server automatically. There is no need
 to release them from the client side in this case.</div>
</li>
</ul>
<a name="markAsPublished-int-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>markAsPublished</h4>
<pre>void&nbsp;markAsPublished(int&nbsp;index)</pre>
<div class="block">Marks the specified column of the current row as published, which implies
 that the tracker should not release the associated locator.
 <p>
 Columns must be marked as published when a LOB object is created on
 the client, to avoid releasing the corresponding locator too early.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>index</code> - 1-based column index</dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
<div class="aboutLanguage">Built on Mon 2017-07-03 23:03:59+0530, from revision Unversioned directory</div>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../org/apache/derby/client/am/Lob.html" title="class in org.apache.derby.client.am"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../../org/apache/derby/client/am/LogicalCallableStatement.html" title="class in org.apache.derby.client.am"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?org/apache/derby/client/am/LOBStateTracker.html" target="_top">Frames</a></li>
<li><a href="LOBStateTracker.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>Apache Derby V10.13 Internals - <i>Copyright &copy; 2004,2016 The Apache Software Foundation. All Rights Reserved.</i></small></p>
</body>
</html>
