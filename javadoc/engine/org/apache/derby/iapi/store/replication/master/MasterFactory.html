<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_66) on Mon Jul 03 23:04:55 IST 2017 -->
<title>MasterFactory (Apache Derby V10.13 Internals)</title>
<meta name="date" content="2017-07-03">
<link rel="stylesheet" type="text/css" href="../../../../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="MasterFactory (Apache Derby V10.13 Internals)";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":6,"i1":6,"i2":6,"i3":6,"i4":6,"i5":6};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],4:["t3","Abstract Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev&nbsp;Class</li>
<li>Next&nbsp;Class</li>
</ul>
<ul class="navList">
<li><a href="../../../../../../../index.html?org/apache/derby/iapi/store/replication/master/MasterFactory.html" target="_top">Frames</a></li>
<li><a href="MasterFactory.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">org.apache.derby.iapi.store.replication.master</div>
<h2 title="Interface MasterFactory" class="title">Interface MasterFactory</h2>
</div>
<div class="contentContainer">
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Known Implementing Classes:</dt>
<dd><a href="../../../../../../../org/apache/derby/impl/store/replication/master/MasterController.html" title="class in org.apache.derby.impl.store.replication.master">MasterController</a></dd>
</dl>
<hr>
<br>
<pre>public interface <span class="typeNameLabel">MasterFactory</span></pre>
<div class="block"><p> 
 This is the interface for the replication master controller
 service. The master controller service is booted when this instance
 of Derby will have the replication master role for this database.
 </p> 
 <p> 
 The replication master service is responsible for managing all
 replication related functionality on the master side of replication.
 This includes connecting to the slave, setting up a log buffer to
 temporarily store log records from the LogFactory, and to ship
 these log records to the slave.
 </p> 
 <p> 
 The master controller currently only supports asynchronous
 replication. This means that there are no guarantees that
 transactions that have committed here (the master side) are also
 reflected on the slave side. However, the slave version of the
 database IS guaranteed to be transaction consistent. This implies
 that: <br>

 <ul>
  <li>A transaction t that is committed on the master will either be
  fully reflected or not be reflected at all on the slave when the
  slave database is turned into a non-replicated database (that is,
  at failover time)</li>

  <li>Slave execution of operations is in the same serial order as
  on the master because replication is based on redoing log records
  to the slave. By definition, log records are in serial order. This
  implies that if transaction t1 commits before t2 on the master,
  and t2 has been committed on the slave, t1 is also guaranteed to
  have committed on the slave.</li>
 </ul>
 </p></div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../../org/apache/derby/iapi/store/replication/master/MasterFactory.html#ASYNCHRONOUS_MODE">ASYNCHRONOUS_MODE</a></span></code>
<div class="block">Property value used to indicate that the service should be
 booted in asynchronous replication mode.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../../org/apache/derby/iapi/store/replication/master/MasterFactory.html#MODULE">MODULE</a></span></code>
<div class="block">The name of the Master Factory, used to boot the service.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../../org/apache/derby/iapi/store/replication/master/MasterFactory.html#REPLICATION_MODE">REPLICATION_MODE</a></span></code>
<div class="block">Property key to specify replication mode</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t3" class="tableTab"><span><a href="javascript:show(4);">Abstract Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../../org/apache/derby/iapi/store/replication/master/MasterFactory.html#appendLog-long-byte:A-int-int-">appendLog</a></span>(long&nbsp;greatestInstant,
         byte[]&nbsp;log,
         int&nbsp;logOffset,
         int&nbsp;logLength)</code>
<div class="block">Append a chunk of log records to the log buffer.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../../org/apache/derby/iapi/store/replication/master/MasterFactory.html#flushedTo-long-">flushedTo</a></span>(long&nbsp;instant)</code>
<div class="block">Used by the LogFactory to notify the replication master
 controller that the log records up to this instant have been
 flushed to disk.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../../org/apache/derby/iapi/store/replication/master/MasterFactory.html#startFailover--">startFailover</a></span>()</code>
<div class="block">Will perform all work needed to failover</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../../org/apache/derby/iapi/store/replication/master/MasterFactory.html#startMaster-org.apache.derby.iapi.store.raw.RawStoreFactory-org.apache.derby.iapi.store.raw.data.DataFactory-org.apache.derby.iapi.store.raw.log.LogFactory-java.lang.String-int-java.lang.String-">startMaster</a></span>(<a href="../../../../../../../org/apache/derby/iapi/store/raw/RawStoreFactory.html" title="interface in org.apache.derby.iapi.store.raw">RawStoreFactory</a>&nbsp;rawStore,
           <a href="../../../../../../../org/apache/derby/iapi/store/raw/data/DataFactory.html" title="interface in org.apache.derby.iapi.store.raw.data">DataFactory</a>&nbsp;dataFac,
           <a href="../../../../../../../org/apache/derby/iapi/store/raw/log/LogFactory.html" title="interface in org.apache.derby.iapi.store.raw.log">LogFactory</a>&nbsp;logFac,
           java.lang.String&nbsp;slavehost,
           int&nbsp;slaveport,
           java.lang.String&nbsp;dbname)</code>
<div class="block">Will perform all the work that is needed to set up replication</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../../org/apache/derby/iapi/store/replication/master/MasterFactory.html#stopMaster--">stopMaster</a></span>()</code>
<div class="block">Will perform all work that is needed to shut down replication.</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../../org/apache/derby/iapi/store/replication/master/MasterFactory.html#workToDo--">workToDo</a></span>()</code>
<div class="block">Used to notify the log shipper that a log buffer element is full.</div>
</td>
</tr>
</table>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="MODULE">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>MODULE</h4>
<pre>static final&nbsp;java.lang.String MODULE</pre>
<div class="block">The name of the Master Factory, used to boot the service.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../../../constant-values.html#org.apache.derby.iapi.store.replication.master.MasterFactory.MODULE">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="REPLICATION_MODE">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>REPLICATION_MODE</h4>
<pre>static final&nbsp;java.lang.String REPLICATION_MODE</pre>
<div class="block">Property key to specify replication mode</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../../../constant-values.html#org.apache.derby.iapi.store.replication.master.MasterFactory.REPLICATION_MODE">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="ASYNCHRONOUS_MODE">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>ASYNCHRONOUS_MODE</h4>
<pre>static final&nbsp;java.lang.String ASYNCHRONOUS_MODE</pre>
<div class="block">Property value used to indicate that the service should be
 booted in asynchronous replication mode.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../../../constant-values.html#org.apache.derby.iapi.store.replication.master.MasterFactory.ASYNCHRONOUS_MODE">Constant Field Values</a></dd>
</dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="startMaster-org.apache.derby.iapi.store.raw.RawStoreFactory-org.apache.derby.iapi.store.raw.data.DataFactory-org.apache.derby.iapi.store.raw.log.LogFactory-java.lang.String-int-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>startMaster</h4>
<pre>void&nbsp;startMaster(<a href="../../../../../../../org/apache/derby/iapi/store/raw/RawStoreFactory.html" title="interface in org.apache.derby.iapi.store.raw">RawStoreFactory</a>&nbsp;rawStore,
                 <a href="../../../../../../../org/apache/derby/iapi/store/raw/data/DataFactory.html" title="interface in org.apache.derby.iapi.store.raw.data">DataFactory</a>&nbsp;dataFac,
                 <a href="../../../../../../../org/apache/derby/iapi/store/raw/log/LogFactory.html" title="interface in org.apache.derby.iapi.store.raw.log">LogFactory</a>&nbsp;logFac,
                 java.lang.String&nbsp;slavehost,
                 int&nbsp;slaveport,
                 java.lang.String&nbsp;dbname)
          throws <a href="../../../../../../../org/apache/derby/iapi/error/StandardException.html" title="class in org.apache.derby.iapi.error">StandardException</a></pre>
<div class="block">Will perform all the work that is needed to set up replication</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>rawStore</code> - The RawStoreFactory for the database</dd>
<dd><code>dataFac</code> - The DataFactory for this database</dd>
<dd><code>logFac</code> - The LogFactory ensuring recoverability for this database</dd>
<dd><code>slavehost</code> - The hostname for the slave</dd>
<dd><code>slaveport</code> - The port the slave is listening on</dd>
<dd><code>dbname</code> - The master database that is being replicated.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../../../org/apache/derby/iapi/error/StandardException.html" title="class in org.apache.derby.iapi.error">StandardException</a></code> - Standard Derby exception policy,
 thrown on replication startup error.</dd>
</dl>
</li>
</ul>
<a name="stopMaster--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>stopMaster</h4>
<pre>void&nbsp;stopMaster()
         throws <a href="../../../../../../../org/apache/derby/iapi/error/StandardException.html" title="class in org.apache.derby.iapi.error">StandardException</a></pre>
<div class="block">Will perform all work that is needed to shut down replication.</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../../../org/apache/derby/iapi/error/StandardException.html" title="class in org.apache.derby.iapi.error">StandardException</a></code> - If the replication master has been stopped
                           already.</dd>
</dl>
</li>
</ul>
<a name="startFailover--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>startFailover</h4>
<pre>void&nbsp;startFailover()
            throws <a href="../../../../../../../org/apache/derby/iapi/error/StandardException.html" title="class in org.apache.derby.iapi.error">StandardException</a></pre>
<div class="block">Will perform all work needed to failover</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../../../org/apache/derby/iapi/error/StandardException.html" title="class in org.apache.derby.iapi.error">StandardException</a></code> - 1) If the failover succeeds, an exception is
                              thrown to indicate that the master database
                              was shutdown after a successful failover
                           2) If a failure occurs during network 
                              communication with slave.</dd>
</dl>
</li>
</ul>
<a name="appendLog-long-byte:A-int-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>appendLog</h4>
<pre>void&nbsp;appendLog(long&nbsp;greatestInstant,
               byte[]&nbsp;log,
               int&nbsp;logOffset,
               int&nbsp;logLength)</pre>
<div class="block">Append a chunk of log records to the log buffer.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>greatestInstant</code> - the instant of the log record that was
                          added last to this chunk of log</dd>
<dd><code>log</code> - the chunk of log records</dd>
<dd><code>logOffset</code> - offset in log to start copy from</dd>
<dd><code>logLength</code> - number of bytes to copy, starting
                          from logOffset</dd>
</dl>
</li>
</ul>
<a name="flushedTo-long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>flushedTo</h4>
<pre>void&nbsp;flushedTo(long&nbsp;instant)</pre>
<div class="block">Used by the LogFactory to notify the replication master
 controller that the log records up to this instant have been
 flushed to disk. The master controller takes action according
 to the current replication strategy when this method is called.

 When the asynchronous replication strategy is used, the method
 does not force log shipping to the slave; the log records may
 be shipped now or later at the MasterFactory's discretion.

 However, if another strategy like 2-safe replication is
 implemented in the future, a call to this method may force log
 shipment before returning control to the caller.

 Currently, only asynchronous replication is supported.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>instant</code> - The highest log instant that has been flushed to
 disk</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../../../org/apache/derby/iapi/store/raw/log/LogFactory.html#flush-org.apache.derby.iapi.store.raw.log.LogInstant-"><code>LogFactory.flush(org.apache.derby.iapi.store.raw.log.LogInstant)</code></a></dd>
</dl>
</li>
</ul>
<a name="workToDo--">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>workToDo</h4>
<pre>void&nbsp;workToDo()</pre>
<div class="block">Used to notify the log shipper that a log buffer element is full.</div>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../../../help-doc.html">Help</a></li>
</ul>
<div class="aboutLanguage">Built on Mon 2017-07-03 23:03:59+0530, from revision Unversioned directory</div>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev&nbsp;Class</li>
<li>Next&nbsp;Class</li>
</ul>
<ul class="navList">
<li><a href="../../../../../../../index.html?org/apache/derby/iapi/store/replication/master/MasterFactory.html" target="_top">Frames</a></li>
<li><a href="MasterFactory.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>Apache Derby V10.13 Internals - <i>Copyright &copy; 2004,2016 The Apache Software Foundation. All Rights Reserved.</i></small></p>
</body>
</html>
