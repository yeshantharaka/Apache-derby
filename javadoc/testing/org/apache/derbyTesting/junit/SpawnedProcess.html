<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_66) on Mon Jul 03 23:06:03 IST 2017 -->
<title>SpawnedProcess (Apache Derby V10.13 Test Javadoc)</title>
<meta name="date" content="2017-07-03">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="SpawnedProcess (Apache Derby V10.13 Test Javadoc)";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":10,"i1":10,"i2":10,"i3":10,"i4":10,"i5":10,"i6":10,"i7":10,"i8":10,"i9":10,"i10":10,"i11":10,"i12":10,"i13":10,"i14":9,"i15":10,"i16":10,"i17":10};
var tabs = {65535:["t0","All Methods"],1:["t1","Static Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../org/apache/derbyTesting/junit/ServerSetup.html" title="class in org.apache.derbyTesting.junit"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../org/apache/derbyTesting/junit/SpawnedProcess.ProcessKillerTask.html" title="class in org.apache.derbyTesting.junit"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?org/apache/derbyTesting/junit/SpawnedProcess.html" target="_top">Frames</a></li>
<li><a href="SpawnedProcess.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">org.apache.derbyTesting.junit</div>
<h2 title="Class SpawnedProcess" class="title">Class SpawnedProcess</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>org.apache.derbyTesting.junit.SpawnedProcess</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public final class <span class="typeNameLabel">SpawnedProcess</span>
extends java.lang.Object</pre>
<div class="block">Utility code that wraps a spawned process (Java Process object).
 <p>
 There are three main aspects handled by this class:
 <ul> <li>Draining the output streams of the process.<br/>
          Happens automatically, the output gathered can be accessed with
          <a href="../../../../org/apache/derbyTesting/junit/SpawnedProcess.html#getFailMessage-java.lang.String-">getFailMessage(java.lang.String)</a>, <a href="../../../../org/apache/derbyTesting/junit/SpawnedProcess.html#getFullServerError--">getFullServerError()</a>,
          <a href="../../../../org/apache/derbyTesting/junit/SpawnedProcess.html#getFullServerOutput--">getFullServerOutput()</a>, and
          <a href="../../../../org/apache/derbyTesting/junit/SpawnedProcess.html#getNextServerOutput--">getNextServerOutput()</a></li>
      <li>Waiting for process completion, followed by cleanup (see
          <a href="../../../../org/apache/derbyTesting/junit/SpawnedProcess.html#complete--">complete()</a> and <a href="../../../../org/apache/derbyTesting/junit/SpawnedProcess.html#complete-long-">complete(long)</a>)</li>
      <li>Forcibly destroying a process that live too long, for instance
          if inter-process communication hangs. This happens automatically
          if a threshold value is exceeded.</li>
 </ul>
 <p>
 <em>Implementation notes</em>: Active waiting is employed when waiting for
 the process to complete. This is considered acceptable since the expected
 usage pattern is to spawn the process, execute a set of tests, and then
 finally asking the process to shut down. Waiting for the process to
 complete is the last step, and a process typically lives only for a short
 period of time anyway (often only for seconds, seldom more than a few
 minutes).
 <br/>
 Forcibly destroying processes that live too long makes the test run
 continue even when facing inter-process communication hangs. The prime
 example is when both the client and the server are waiting for the other
 party to send data. Since the timeout is very high this feature is intended
 to avoid automated test runs from hanging indefinitely, for instance due to
 environmental issues affecting the process.</div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="nested.class.summary">
<!--   -->
</a>
<h3>Nested Class Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Nested Class Summary table, listing nested classes, and an explanation">
<caption><span>Nested Classes</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Class and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static class&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/apache/derbyTesting/junit/SpawnedProcess.ProcessKillerTask.html" title="class in org.apache.derbyTesting.junit">SpawnedProcess.ProcessKillerTask</a></span></code>
<div class="block">A task that will kill the specified process.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static class&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/apache/derbyTesting/junit/SpawnedProcess.StreamSaver.html" title="class in org.apache.derbyTesting.junit">SpawnedProcess.StreamSaver</a></span></code>
<div class="block">Class holding references to a stream that receives the output from a
 process and a thread that reads the process output and passes it on
 to the stream.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private <a href="../../../../org/apache/derbyTesting/junit/SpawnedProcess.StreamSaver.html" title="class in org.apache.derbyTesting.junit">SpawnedProcess.StreamSaver</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/apache/derbyTesting/junit/SpawnedProcess.html#errSaver">errSaver</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private java.lang.Process</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/apache/derbyTesting/junit/SpawnedProcess.html#javaProcess">javaProcess</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/apache/derbyTesting/junit/SpawnedProcess.html#KILL_THRESHOLD">KILL_THRESHOLD</a></span></code>
<div class="block">The maximum allowed time for a process to live.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/apache/derbyTesting/junit/SpawnedProcess.html#KILL_THRESHOLD_DEFAULT">KILL_THRESHOLD_DEFAULT</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/apache/derbyTesting/junit/SpawnedProcess.html#KILL_THRESHOLD_PROPERTY">KILL_THRESHOLD_PROPERTY</a></span></code>
<div class="block">Property allowing the kill threshold to be overridden.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static java.util.Timer</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/apache/derbyTesting/junit/SpawnedProcess.html#KILL_TIMER">KILL_TIMER</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private java.util.TimerTask</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/apache/derbyTesting/junit/SpawnedProcess.html#killTask">killTask</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/apache/derbyTesting/junit/SpawnedProcess.html#name">name</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private <a href="../../../../org/apache/derbyTesting/junit/SpawnedProcess.StreamSaver.html" title="class in org.apache.derbyTesting.junit">SpawnedProcess.StreamSaver</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/apache/derbyTesting/junit/SpawnedProcess.html#outSaver">outSaver</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/apache/derbyTesting/junit/SpawnedProcess.html#stdOutReadOffset">stdOutReadOffset</a></span></code>
<div class="block">Position offset for getNextServerOutput().</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/apache/derbyTesting/junit/SpawnedProcess.html#suppressOutput">suppressOutput</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/apache/derbyTesting/junit/SpawnedProcess.html#TAG">TAG</a></span></code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../org/apache/derbyTesting/junit/SpawnedProcess.html#SpawnedProcess-java.lang.Process-java.lang.String-">SpawnedProcess</a></span>(java.lang.Process&nbsp;javaProcess,
              java.lang.String&nbsp;name)</code>
<div class="block">Creates a new wrapper to handle the given process.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t1" class="tableTab"><span><a href="javascript:show(1);">Static Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/apache/derbyTesting/junit/SpawnedProcess.html#cleanupProcess--">cleanupProcess</a></span>()</code>
<div class="block">Cleans up the process, explicitly closing the streams associated with it.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/apache/derbyTesting/junit/SpawnedProcess.html#closeStream-java.lang.Object-">closeStream</a></span>(java.lang.Object&nbsp;stream)</code>
<div class="block">Closes the specified stream, ignoring any exceptions.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/apache/derbyTesting/junit/SpawnedProcess.html#complete--">complete</a></span>()</code>
<div class="block">Waits for the process to terminate.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/apache/derbyTesting/junit/SpawnedProcess.html#complete-long-">complete</a></span>(long&nbsp;timeout)</code>
<div class="block">Waits for the process to terminate, forcibly terminating it if it
 takes longer than the specified timeout.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/apache/derbyTesting/junit/SpawnedProcess.html#getFailMessage-java.lang.String-">getFailMessage</a></span>(java.lang.String&nbsp;reason)</code>
<div class="block">Get a fail message that is the passed in reason plus
 the stderr and stdout for any output written.</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/apache/derbyTesting/junit/SpawnedProcess.html#getFullServerError--">getFullServerError</a></span>()</code>
<div class="block">Get the full server error output (stderr) as a string using the default
 encoding which is assumed is how it was originally written.</div>
</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/apache/derbyTesting/junit/SpawnedProcess.html#getFullServerOutput--">getFullServerOutput</a></span>()</code>
<div class="block">
 Get the full server output (stdout) as a string using the default
 encoding which is assumed is how it was originally written.</div>
</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/apache/derbyTesting/junit/SpawnedProcess.html#getNextServerOutput--">getNextServerOutput</a></span>()</code>
<div class="block">Get the next set of server output (stdout) as a string using the default
 encoding which is assumed is how it was originally
 written.</div>
</td>
</tr>
<tr id="i8" class="altColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/apache/derbyTesting/junit/SpawnedProcess.html#getPid--">getPid</a></span>()</code>
<div class="block">Return the pid if on Unixen, or -1 on Windows (can't be obtained).</div>
</td>
</tr>
<tr id="i9" class="rowColor">
<td class="colFirst"><code>java.lang.Process</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/apache/derbyTesting/junit/SpawnedProcess.html#getProcess--">getProcess</a></span>()</code>
<div class="block">Get the Java Process object</div>
</td>
</tr>
<tr id="i10" class="altColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/apache/derbyTesting/junit/SpawnedProcess.html#joinWith-java.lang.Thread-">joinWith</a></span>(java.lang.Thread&nbsp;t)</code>
<div class="block">Joins up with the specified thread.</div>
</td>
</tr>
<tr id="i11" class="rowColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/apache/derbyTesting/junit/SpawnedProcess.html#jstack--">jstack</a></span>()</code>
<div class="block">Return the jstack(1) dump of the process if possible.</div>
</td>
</tr>
<tr id="i12" class="altColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/apache/derbyTesting/junit/SpawnedProcess.html#printDiagnostics-int-">printDiagnostics</a></span>(int&nbsp;exitCode)</code>
<div class="block">Prints diagnostics to stdout/stderr if the process failed.</div>
</td>
</tr>
<tr id="i13" class="rowColor">
<td class="colFirst"><code>private java.util.TimerTask</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/apache/derbyTesting/junit/SpawnedProcess.html#scheduleKill-java.lang.Process-java.lang.String-">scheduleKill</a></span>(java.lang.Process&nbsp;process,
            java.lang.String&nbsp;name)</code>
<div class="block">Schedules a task to kill/terminate the task after a predefined timeout.</div>
</td>
</tr>
<tr id="i14" class="altColor">
<td class="colFirst"><code>private static void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/apache/derbyTesting/junit/SpawnedProcess.html#sleep-long-">sleep</a></span>(long&nbsp;ms)</code>&nbsp;</td>
</tr>
<tr id="i15" class="rowColor">
<td class="colFirst"><code>private <a href="../../../../org/apache/derbyTesting/junit/SpawnedProcess.StreamSaver.html" title="class in org.apache.derbyTesting.junit">SpawnedProcess.StreamSaver</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/apache/derbyTesting/junit/SpawnedProcess.html#startStreamSaver-java.io.InputStream-java.lang.String-">startStreamSaver</a></span>(java.io.InputStream&nbsp;in,
                java.lang.String&nbsp;name)</code>
<div class="block">Creates and starts a stream saver that reads the specified input stream
 in a separate stream.</div>
</td>
</tr>
<tr id="i16" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/apache/derbyTesting/junit/SpawnedProcess.html#suppressOutputOnComplete--">suppressOutputOnComplete</a></span>()</code>
<div class="block">Causes output obtained from the process to be suppressed when
 executing the <code>complete</code>-methods.</div>
</td>
</tr>
<tr id="i17" class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../org/apache/derbyTesting/junit/SpawnedProcess.html#waitForExit-long-long-">waitForExit</a></span>(long&nbsp;patience,
           long&nbsp;sleepInterval)</code>
<div class="block">Return <code>true</code> if the subprocess <code>p</code> has exited within <code>patience</code> milliseconds.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="TAG">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>TAG</h4>
<pre>private static final&nbsp;java.lang.String TAG</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../constant-values.html#org.apache.derbyTesting.junit.SpawnedProcess.TAG">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="KILL_TIMER">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>KILL_TIMER</h4>
<pre>private static&nbsp;java.util.Timer KILL_TIMER</pre>
</li>
</ul>
<a name="KILL_THRESHOLD_PROPERTY">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>KILL_THRESHOLD_PROPERTY</h4>
<pre>private static final&nbsp;java.lang.String KILL_THRESHOLD_PROPERTY</pre>
<div class="block">Property allowing the kill threshold to be overridden.
 <p>
 Interprets the numeric value as milliseconds, ignored if non-numeric.
 Overriding this value may be required if the test machine is extremely
 slow, or you want to kill hung processes earlier for some reason.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../constant-values.html#org.apache.derbyTesting.junit.SpawnedProcess.KILL_THRESHOLD_PROPERTY">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="KILL_THRESHOLD_DEFAULT">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>KILL_THRESHOLD_DEFAULT</h4>
<pre>private static final&nbsp;long KILL_THRESHOLD_DEFAULT</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../constant-values.html#org.apache.derbyTesting.junit.SpawnedProcess.KILL_THRESHOLD_DEFAULT">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="KILL_THRESHOLD">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>KILL_THRESHOLD</h4>
<pre>private static final&nbsp;long KILL_THRESHOLD</pre>
<div class="block">The maximum allowed time for a process to live.</div>
</li>
</ul>
<a name="name">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>name</h4>
<pre>private final&nbsp;java.lang.String name</pre>
</li>
</ul>
<a name="javaProcess">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>javaProcess</h4>
<pre>private final&nbsp;java.lang.Process javaProcess</pre>
</li>
</ul>
<a name="errSaver">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>errSaver</h4>
<pre>private final&nbsp;<a href="../../../../org/apache/derbyTesting/junit/SpawnedProcess.StreamSaver.html" title="class in org.apache.derbyTesting.junit">SpawnedProcess.StreamSaver</a> errSaver</pre>
</li>
</ul>
<a name="outSaver">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>outSaver</h4>
<pre>private final&nbsp;<a href="../../../../org/apache/derbyTesting/junit/SpawnedProcess.StreamSaver.html" title="class in org.apache.derbyTesting.junit">SpawnedProcess.StreamSaver</a> outSaver</pre>
</li>
</ul>
<a name="suppressOutput">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>suppressOutput</h4>
<pre>private&nbsp;boolean suppressOutput</pre>
</li>
</ul>
<a name="killTask">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>killTask</h4>
<pre>private final&nbsp;java.util.TimerTask killTask</pre>
</li>
</ul>
<a name="stdOutReadOffset">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>stdOutReadOffset</h4>
<pre>int stdOutReadOffset</pre>
<div class="block">Position offset for getNextServerOutput().</div>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="SpawnedProcess-java.lang.Process-java.lang.String-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>SpawnedProcess</h4>
<pre>public&nbsp;SpawnedProcess(java.lang.Process&nbsp;javaProcess,
                      java.lang.String&nbsp;name)</pre>
<div class="block">Creates a new wrapper to handle the given process.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>javaProcess</code> - a (running) process</dd>
<dd><code>name</code> - name to associate with the process</dd>
</dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="sleep-long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>sleep</h4>
<pre>private static&nbsp;void&nbsp;sleep(long&nbsp;ms)</pre>
</li>
</ul>
<a name="scheduleKill-java.lang.Process-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>scheduleKill</h4>
<pre>private&nbsp;java.util.TimerTask&nbsp;scheduleKill(java.lang.Process&nbsp;process,
                                         java.lang.String&nbsp;name)</pre>
<div class="block">Schedules a task to kill/terminate the task after a predefined timeout.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>name</code> - name of the process</dd>
<dd><code>process</code> - the process</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The task object.</dd>
</dl>
</li>
</ul>
<a name="suppressOutputOnComplete--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>suppressOutputOnComplete</h4>
<pre>public&nbsp;void&nbsp;suppressOutputOnComplete()</pre>
<div class="block">Causes output obtained from the process to be suppressed when
 executing the <code>complete</code>-methods.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../org/apache/derbyTesting/junit/SpawnedProcess.html#getFullServerOutput--"><code>to obtain suppressed output from stdout</code></a>, 
<a href="../../../../org/apache/derbyTesting/junit/SpawnedProcess.html#getFullServerError--"><code>to obtain suppressed output from stderr</code></a></dd>
</dl>
</li>
</ul>
<a name="getProcess--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getProcess</h4>
<pre>public&nbsp;java.lang.Process&nbsp;getProcess()</pre>
<div class="block">Get the Java Process object</div>
</li>
</ul>
<a name="getFullServerOutput--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getFullServerOutput</h4>
<pre>public&nbsp;java.lang.String&nbsp;getFullServerOutput()
                                     throws java.lang.InterruptedException</pre>
<div class="block"><p>
 Get the full server output (stdout) as a string using the default
 encoding which is assumed is how it was originally written.
 </p>

 <p>
 This method should only be called after the process has completed.
 That is, <a href="../../../../org/apache/derbyTesting/junit/SpawnedProcess.html#complete--"><code>complete()</code></a> or <a href="../../../../org/apache/derbyTesting/junit/SpawnedProcess.html#complete-long-"><code>complete(long)</code></a>
 should be called first.
 </p></div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.InterruptedException</code></dd>
</dl>
</li>
</ul>
<a name="getFullServerError--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getFullServerError</h4>
<pre>public&nbsp;java.lang.String&nbsp;getFullServerError()
                                    throws java.lang.InterruptedException</pre>
<div class="block">Get the full server error output (stderr) as a string using the default
 encoding which is assumed is how it was originally written.
 <p>
 This method should only be called after the process has completed.
 That is, <a href="../../../../org/apache/derbyTesting/junit/SpawnedProcess.html#complete--"><code>complete()</code></a> or <a href="../../../../org/apache/derbyTesting/junit/SpawnedProcess.html#complete-long-"><code>complete(long)</code></a>
 should be called first.</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.InterruptedException</code></dd>
</dl>
</li>
</ul>
<a name="getNextServerOutput--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getNextServerOutput</h4>
<pre>public&nbsp;java.lang.String&nbsp;getNextServerOutput()</pre>
<div class="block">Get the next set of server output (stdout) as a string using the default
 encoding which is assumed is how it was originally
 written. Assumes a single caller is executing the calls
 to this method.</div>
</li>
</ul>
<a name="getFailMessage-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getFailMessage</h4>
<pre>public&nbsp;java.lang.String&nbsp;getFailMessage(java.lang.String&nbsp;reason)</pre>
<div class="block">Get a fail message that is the passed in reason plus
 the stderr and stdout for any output written. Allows
 easier debugging if the reason the process failed is there!</div>
</li>
</ul>
<a name="complete--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>complete</h4>
<pre>public&nbsp;int&nbsp;complete()
             throws java.io.IOException</pre>
<div class="block">Waits for the process to terminate.
 <p>
 This call will block until one of the following conditions are met:
 <ul> <li>the process terminates on its own</li>
      <li>the hung-process watchdog mechanism forcibly terminates the
          process (see <a href="../../../../org/apache/derbyTesting/junit/SpawnedProcess.html#scheduleKill-java.lang.Process-java.lang.String-">scheduleKill(java.lang.Process, java.lang.String)</a>)</li></div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The process exit code.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code> - if printing diagnostics fails</dd>
</dl>
</li>
</ul>
<a name="complete-long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>complete</h4>
<pre>public&nbsp;int&nbsp;complete(long&nbsp;timeout)
             throws java.io.IOException</pre>
<div class="block">Waits for the process to terminate, forcibly terminating it if it
 takes longer than the specified timeout.
 <p>
 This call will block until one of the following conditions are met:
 <ul> <li>the process terminates on its own</li>
      <li>the timeout is exceeded, at which point the process is
          forcibly destroyed</li>
      <li>the hung-process watchdog mechanism forcibly terminates the
          process (see <a href="../../../../org/apache/derbyTesting/junit/SpawnedProcess.html#scheduleKill-java.lang.Process-java.lang.String-">scheduleKill(java.lang.Process, java.lang.String)</a>)</li></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>timeout</code> - the number of milliseconds to wait for the process
                to terminate normally before destroying it</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The process exit code.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code> - if printing diagnostics fails</dd>
</dl>
</li>
</ul>
<a name="cleanupProcess--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>cleanupProcess</h4>
<pre>private&nbsp;void&nbsp;cleanupProcess()</pre>
<div class="block">Cleans up the process, explicitly closing the streams associated with it.</div>
</li>
</ul>
<a name="printDiagnostics-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>printDiagnostics</h4>
<pre>private&nbsp;void&nbsp;printDiagnostics(int&nbsp;exitCode)
                       throws java.io.IOException</pre>
<div class="block">Prints diagnostics to stdout/stderr if the process failed.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>exitCode</code> - the exit code of the spawned process</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code> - if writing to an output stream fails</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../org/apache/derbyTesting/junit/SpawnedProcess.html#suppressOutput"><code>suppressOutput</code></a></dd>
</dl>
</li>
</ul>
<a name="joinWith-java.lang.Thread-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>joinWith</h4>
<pre>private&nbsp;void&nbsp;joinWith(java.lang.Thread&nbsp;t)</pre>
<div class="block">Joins up with the specified thread.</div>
</li>
</ul>
<a name="closeStream-java.lang.Object-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>closeStream</h4>
<pre>private&nbsp;void&nbsp;closeStream(java.lang.Object&nbsp;stream)</pre>
<div class="block">Closes the specified stream, ignoring any exceptions.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>stream</code> - stream to close (may be <code>null</code>)</dd>
</dl>
</li>
</ul>
<a name="startStreamSaver-java.io.InputStream-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>startStreamSaver</h4>
<pre>private&nbsp;<a href="../../../../org/apache/derbyTesting/junit/SpawnedProcess.StreamSaver.html" title="class in org.apache.derbyTesting.junit">SpawnedProcess.StreamSaver</a>&nbsp;startStreamSaver(java.io.InputStream&nbsp;in,
                                                    java.lang.String&nbsp;name)</pre>
<div class="block">Creates and starts a stream saver that reads the specified input stream
 in a separate stream.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>in</code> - input stream to read from</dd>
<dd><code>name</code> - name of the thread</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>A <code>StreamSaver</code> object.</dd>
</dl>
</li>
</ul>
<a name="waitForExit-long-long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>waitForExit</h4>
<pre>public&nbsp;boolean&nbsp;waitForExit(long&nbsp;patience,
                           long&nbsp;sleepInterval)
                    throws java.lang.InterruptedException</pre>
<div class="block">Return <code>true</code> if the subprocess <code>p</code> has exited within <code>patience</code> milliseconds. Sleep <code>sleepInterval</code> between each check}.
 Note: you still need to call one of the <a href="../../../../org/apache/derbyTesting/junit/SpawnedProcess.html#complete--"><code>complete()</code></a> overloads even
 if using this method (which is optional). It can be used before trying
 a <a href="../../../../org/apache/derbyTesting/junit/SpawnedProcess.html#jstack--"><code>jstack()</code></a> call.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>patience</code> - the maximum milliseconds we want to wait for</dd>
<dd><code>sleepInterval</code> - sleep for this amount of milliseconds before trying
                      testing again if not already exited the first time
                      we check. If patience &lt;= sleepInterval we only
                      check once.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>true if the process exited before our patience is up.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.InterruptedException</code></dd>
</dl>
</li>
</ul>
<a name="jstack--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>jstack</h4>
<pre>public&nbsp;java.lang.String&nbsp;jstack()
                        throws java.security.PrivilegedActionException,
                               java.lang.InterruptedException</pre>
<div class="block">Return the jstack(1) dump of the process if possible.
 It will only work if we are running with a full JDK, not a simple JRE.
 It will not work on Windows, and just return an empty string.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>jstack dump if possible</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.security.PrivilegedActionException</code></dd>
<dd><code>java.lang.InterruptedException</code></dd>
</dl>
</li>
</ul>
<a name="getPid--">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>getPid</h4>
<pre>public&nbsp;int&nbsp;getPid()
           throws java.security.PrivilegedActionException</pre>
<div class="block">Return the pid if on Unixen, or -1 on Windows (can't be obtained).</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>pid</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.security.PrivilegedActionException</code></dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
<div class="aboutLanguage">Built on Mon 2017-07-03 23:03:59+0530, from revision Unversioned directory</div>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../org/apache/derbyTesting/junit/ServerSetup.html" title="class in org.apache.derbyTesting.junit"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../org/apache/derbyTesting/junit/SpawnedProcess.ProcessKillerTask.html" title="class in org.apache.derbyTesting.junit"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?org/apache/derbyTesting/junit/SpawnedProcess.html" target="_top">Frames</a></li>
<li><a href="SpawnedProcess.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>Apache Derby V10.13 Internals - <i>Copyright &copy; 2004,2016 The Apache Software Foundation. All Rights Reserved.</i></small></p>
</body>
</html>
